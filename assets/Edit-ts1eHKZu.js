import{e as L,z as P,j as p,q as G,w as T,o as a,A as d,B as u,E as z,l as e,u as r,b as m,k as f,J as v,P as Y,S as q,F as A,H,G as I,D as h,T as V,N as J}from"./vue.esm-bundler-CYPfFjdk.js";import{s as O}from"./schemas-74JEr9Jm.js";import{R as K}from"./RightDrawer-Lpr6admO.js";import{a as Q,f as W,A as X}from"./preview-D0Pi-YKn.js";import{I as Z}from"./IconClose-tbzieUCA.js";import{P as F}from"./ProgressSpinner-lCLkagxy.js";import{_ as ee,a as te}from"./ActionErrorAlert--bGVRXV4.js";import{u as ie}from"./useTraining-wSOngOuP.js";import{_ as se}from"./VTrainingCategorySelect-f8ZTFtAS.js";import{_ as oe}from"./VDepartmentSelect-fFgtBnGn.js";import{u as re}from"./useAbility-sIzGf7dM.js";import{u as ae}from"./training-vlKiH_tm.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./IconTickMarkCircle-2_sKm8Jk.js";import"./useDepartment-RZahlhen.js";import"./useAuth-8d_1_S6I.js";const ne={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},le={class:"sticky top-0 z-10 flex w-full items-center justify-end bg-white p-6"},de=e("div",{class:"mb-6"},[e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," View/Edit Training. "),e("p",{class:"mt-1 text-sm text-gray-500"}," Use the form below to update this training. ")],-1),me={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6"},ce=e("p",{class:"mb-1 block text-sm font-medium text-gray-700"}," Department ",-1),pe=e("label",{for:"training_name",class:"block text-sm font-medium text-gray-700"}," Training Name ",-1),ue={class:"mt-1"},fe={class:"grid grid-cols-3 gap-4"},ge=e("p",{class:"mb-1 block text-sm font-medium text-gray-700"}," Training Category ",-1),_e=e("label",{for:"requiresFeedback",class:"block text-sm font-medium text-gray-700"}," Requires Feedback ",-1),ve={class:"mt-1"},he=e("option",{value:1}," Yes ",-1),be=e("option",{value:0}," No ",-1),ye=[he,be],xe=e("label",{for:"mandatory",class:"block text-sm font-medium text-gray-700"}," Mandatory ",-1),ke={class:"mt-1"},we=e("option",{value:1}," Yes ",-1),Te=e("option",{value:0}," No ",-1),qe=[we,Te],Ae={class:"pt-8"},Ie=e("label",{for:"departure_date_and_time",class:"block text-sm font-medium text-gray-700"}," Required Abilities ",-1),Ve=e("p",{class:"mt-1 text-sm text-gray-500"}," In order to create logs for this training, staff must have the abilities listed below. Logs for this training are also visible only to users with any of these abilities (or the staff to whom the log belongs). ",-1),Fe={class:"mt-6"},Ne={class:"space-y-4"},Re={class:"grid grid-cols-1 gap-3 md:grid-cols-2"},Ee={class:"flex h-5 items-center"},Ce=["id","checked","onChange"],Se={class:"ml-3 flex items-center space-x-1 text-sm"},Ue={class:"flex h-5 w-5 items-center justify-center"},De=["src"],Be=["for"],$e={class:"text-gray-500"},je={class:"relative pt-5"},Me={class:"flex items-center justify-end"},Le={class:"flex items-center"},Pe={key:0},Ge=L({__name:"Edit",props:{trainingId:{}},setup(N){const R=N,{trainingId:b}=P(R),{validateForm:E,actionIsInProgress:g,actionIsInError:C,actionIsInSuccess:S}=Q(),y=p(null),{getTrainingById:x,trainingActions:n,editTraining:U}=ie(),{apiGetAbilitiesByDepartments:_}=re(),{storeFilterState:D}=O(W()),{storeUpdateTraining:B,storeRemoveTraining:$}=ae(),i=p(null),c=p([]);G(async()=>{const s=await x(b.value.toString());if(s){i.value=s;const t=await _([s.department]);t&&(c.value=t.data.abilities)}}),T(b,async s=>{if(s){const t=await x(s.toString());if(t){i.value=t;const l=await _([t.department]);l&&(c.value=l.data.abilities)}}});const k=p(!0);T(()=>{var s;return(s=i.value)==null?void 0:s.department.id},async s=>{if(s&&i.value&&!k.value){const t=await _([i.value.department]);t&&(c.value=t.data.abilities),i.value.requiredAbilities=[]}else k.value=!1});const j=async()=>{var t;const s=await E(y.value,()=>{i.value&&U(i.value)});s&&(i.value=s,s.department.id===((t=D.value.selectedDepartment)==null?void 0:t.id)?B(s):$(s))},M=s=>{const t=i.value.requiredAbilities.findIndex(l=>l.id===s.id);t===-1?i.value.requiredAbilities.push(s):i.value.requiredAbilities.splice(t,1)};return(s,t)=>{const l=z("RouterLink");return a(),d(K,null,{default:u(()=>[e("div",ne,[e("div",le,[r(g)(r(n).getTrainingById)||r(g)(r(n).editTraining)?(a(),d(F,{key:0,class:"h-5 w-5 text-blue-500"})):(a(),d(l,{key:1,to:{name:s.$Routes.Training}},{default:u(()=>[m(Z,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"]))]),e("form",{id:"edit_training_form",ref_key:"editTrainingFormElement",ref:y,class:"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12"},[de,i.value?(a(),f(A,{key:0},[e("div",me,[e("div",null,[ce,m(oe,{modelValue:i.value.department,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value.department=o),"department-permissions-required":[r(X).MANAGE_TRAINING]},null,8,["modelValue","department-permissions-required"])]),e("div",null,[pe,e("div",ue,[v(e("input",{id:"training_name","onUpdate:modelValue":t[1]||(t[1]=o=>i.value.name=o),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[Y,i.value.name]])])]),e("div",fe,[e("div",null,[ge,m(se,{modelValue:i.value.category.id,"onUpdate:modelValue":t[2]||(t[2]=o=>i.value.category.id=o)},null,8,["modelValue"])]),e("div",null,[_e,e("div",ve,[v(e("select",{id:"requiresFeedback","onUpdate:modelValue":t[3]||(t[3]=o=>i.value.requiresFeedback=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},ye,512),[[q,i.value.requiresFeedback]])])]),e("div",null,[xe,e("div",ke,[v(e("select",{id:"mandatory","onUpdate:modelValue":t[4]||(t[4]=o=>i.value.mandatory=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},qe,512),[[q,i.value.mandatory]])])])])]),e("div",Ae,[Ie,Ve,e("div",Fe,[e("fieldset",null,[e("div",Ne,[e("div",Re,[(a(!0),f(A,null,H(c.value,o=>(a(),f("div",{key:o.id,class:"relative flex items-start"},[e("div",Ee,[e("input",{id:`required_${o.slug}`,checked:i.value.requiredAbilities.find(w=>w.slug===o.slug)!==void 0,type:"checkbox",class:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500",onChange:w=>M(o)},null,40,Ce)]),e("div",Se,[e("div",Ue,[e("img",{src:o.iconUrl,alt:"Ability icon."},null,8,De)]),e("label",{for:`required_${o.slug}`,class:"cursor-pointer font-medium text-gray-700"},I(o.name),9,Be),e("p",$e,I(o.description),1)])]))),128))])])])])]),e("div",je,[e("div",Me,[m(V,{name:"alert"},{default:u(()=>[r(S)(r(n).editTraining)?(a(),d(ee,{key:0,action:r(n).editTraining},null,8,["action"])):h("",!0)]),_:1}),m(V,{name:"alert"},{default:u(()=>[r(C)(r(n).editTraining)?(a(),d(te,{key:0,action:r(n).editTraining},null,8,["action"])):h("",!0)]),_:1}),e("div",Le,[e("button",{class:"ml-3 inline-flex h-9 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700",onClick:J(j,["prevent"])},[r(g)(r(n).editTraining)?(a(),d(F,{key:1,class:"h-3 w-3 text-white"})):(a(),f("span",Pe," Apply Changes "))])])])])],64)):h("",!0)],512)])]),_:1})}}});Ge.__docgenInfo={exportName:"default",displayName:"Edit",description:"",tags:{},props:[{name:"trainingId",required:!0,type:{name:"number"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/training/Edit.vue"]};export{Ge as default};
