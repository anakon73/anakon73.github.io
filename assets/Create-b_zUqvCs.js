import{e as E,j as d,q as R,n as P,V,o as s,A as n,B as m,E as j,l as e,u as o,b as c,J as q,P as G,G as b,D as h,T as x,N as $,k as z}from"./vue.esm-bundler-CYPfFjdk.js";import{s as J}from"./schemas-74JEr9Jm.js";import{R as H}from"./RightDrawer-Lpr6admO.js";import{a as K,f as Q,A as W}from"./preview-D0Pi-YKn.js";import{I as X}from"./IconClose-tbzieUCA.js";import{P as y}from"./ProgressSpinner-lCLkagxy.js";import{_ as Y,a as Z}from"./ActionErrorAlert--bGVRXV4.js";import{u as ee,a as te}from"./useOperationalBase-kvvO22e1.js";import{u as ae}from"./useMap-r2WMKGtK.js";import{_ as oe}from"./VDataFilters-2mcnRfw0.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./IconTickMarkCircle-2_sKm8Jk.js";import"./leaflet-src-KPccyqlJ.js";import"./useDepartment-RZahlhen.js";import"./useRole-JNprELZd.js";import"./useAuth-8d_1_S6I.js";var u=(p=>(p.LAT="64.025125",p.LNG="-16.978723",p))(u||{});const re={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},ie={class:"sticky top-0 z-[9999999] flex w-full items-center justify-end bg-white p-6"},se=e("div",{class:"mb-6"},[e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," Create Operational Base. "),e("p",{class:"mt-1 text-sm text-gray-500"}," Use the form below to create a new Operational Base. ")],-1),le={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6"},ne=e("label",{for:"operational_base_name",class:"block text-sm font-medium text-gray-700"}," Operational Base Name ",-1),pe={class:"mt-1"},me={class:"flex flex-col"},ce=e("label",{for:"operational_base_name",class:"mb-1 block text-sm font-medium text-gray-700"}," Location ",-1),de=e("div",{id:"map",class:"h-[400px] w-full bg-gray-100"},null,-1),ue={class:"text-xs italic text-gray-500"},fe={class:"relative pt-5"},_e={class:"flex items-center justify-end"},ve={class:"flex items-center"},ge={key:0},be=E({__name:"Create",setup(p){const{validateForm:B,actionIsInProgress:f,actionIsInError:O,actionIsInSuccess:k}=K(),{operationalBaseActions:l,createOperationalBase:w}=ee(),{storeFilterState:N}=J(Q()),{storeAddOperationalBase:T}=te(),_=d(null),{createMap:A,addLayersToMap:I,createOperationalBaseMarker:v,resetMapView:M,tidyUpMap:S}=ae(),g=d({selectedDepartment:null,selectedOperationalBase:null,selectedRole:null,selectedMonth:"",selectedDate:""}),a=d({departmentId:0,name:"",longitude:u.LNG,latitude:u.LAT}),F=async t=>{g.value=t,t.selectedDepartment&&(a.value.departmentId=t.selectedDepartment.id)},L=async()=>{var r;const t=await B(_.value,()=>w(a.value));t&&t.department.id===((r=N.value.selectedDepartment)==null?void 0:r.id)&&T(t)};let i=null;const C=()=>{i=A(Number.parseFloat(a.value.latitude),Number.parseFloat(a.value.longitude),3),I(i);let t=v(Number.parseFloat(a.value.latitude),Number.parseFloat(a.value.longitude));t.addTo(i),i.on("click",r=>{a.value.latitude=r.latlng.lat.toString(),a.value.longitude=r.latlng.lng.toString(),t&&i.removeLayer(t),t=v(r.latlng.lat,r.latlng.lng),t.addTo(i)}),M(i,Number.parseFloat(a.value.latitude),Number.parseFloat(a.value.longitude),7)};return R(()=>{P(()=>{setTimeout(()=>{C()},400)})}),V(()=>{S(i)}),(t,r)=>{const D=j("RouterLink");return s(),n(H,null,{default:m(()=>[e("div",re,[e("div",ie,[o(f)(o(l).createOperationalBase)?(s(),n(y,{key:0,class:"h-5 w-5 text-blue-500"})):(s(),n(D,{key:1,to:{name:t.$Routes.OperationalBases}},{default:m(()=>[c(X,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"]))]),e("form",{id:"create_operational_base_form",ref_key:"createOperationalBaseFormElement",ref:_,class:"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12"},[se,e("div",le,[c(oe,{"department-permissions-required":[o(W).MANAGE_OPERATIONAL_BASES],"filter-state":g.value,onFilterStateUpdated:F},null,8,["department-permissions-required","filter-state"]),e("div",null,[ne,e("div",pe,[q(e("input",{id:"operational_base_name","onUpdate:modelValue":r[0]||(r[0]=U=>a.value.name=U),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[G,a.value.name]])])]),e("div",me,[ce,de,e("p",ue,b(a.value.latitude)+", "+b(a.value.longitude),1)])]),e("div",fe,[e("div",_e,[c(x,{name:"alert"},{default:m(()=>[o(k)(o(l).createOperationalBase)?(s(),n(Y,{key:0,action:o(l).createOperationalBase},null,8,["action"])):h("",!0)]),_:1}),c(x,{name:"alert"},{default:m(()=>[o(O)(o(l).createOperationalBase)?(s(),n(Z,{key:0,action:o(l).createOperationalBase},null,8,["action"])):h("",!0)]),_:1}),e("div",ve,[e("button",{class:"ml-3 inline-flex h-9 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700",onClick:$(L,["prevent"])},[o(f)(o(l).createOperationalBase)?(s(),n(y,{key:1,class:"h-3 w-3 text-white"})):(s(),z("span",ge," Save Operational Base "))])])])])],512)])]),_:1})}}});be.__docgenInfo={exportName:"default",displayName:"Create",description:"",tags:{},sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/operational-bases/Create.vue"]};export{be as default};
