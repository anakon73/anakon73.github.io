import{e as F,j as k,o as s,k as l,l as t,G as w,u as P,A as S,R as $,Q as M,q as B,w as U,D as I,F as D,H as C,N,J as j,O as L}from"./vue.esm-bundler-CYPfFjdk.js";import{u as G,a as A}from"./preview-D0Pi-YKn.js";import{P as R}from"./ProgressSpinner-lCLkagxy.js";import{u as H}from"./useRole-JNprELZd.js";import{_ as T}from"./FeedbackWarning-iVsjxw1W.js";import{I as E}from"./IconAccount-3MIbJHaP.js";import{u as z}from"./useHelpers-Uc_HlRzD.js";import{u as J}from"./useAbility-sIzGf7dM.js";import{d as O,s as Q}from"./schemas-74JEr9Jm.js";function K(){const{apiClient:u}=G(),{addToActionsInProgress:_,processActionError:i,processActionSuccess:c,resetActionsInError:f,resetActionsInSuccess:y}=A(),m={uploadImage:{id:"uploadImage",successMessage:"Image uploaded successfully.",errorMessage:"There was a problem uploading the image."}};return{uploadImage:async(g,o)=>{f(),y(),_(m.uploadImage);try{const d=new FormData;d.append("image",g),d.append("image_storage_directory",o);const r=await u.post("/api/upload-image",d,{headers:{"Content-Type":"multipart/form-data"}});return c(m.uploadImage),r.data}catch(d){console.log(d),i(m.uploadImage,d)}},uploadImageActions:m}}const W={for:"imageUpload",class:"block text-sm font-medium text-gray-700"},X={class:"mt-1 flex items-center"},Y={class:"flex h-12 w-12 items-center justify-center overflow-hidden rounded-full bg-gray-100"},Z=["src"],ee=["src"],te={key:3,class:"h-full w-full text-gray-300",fill:"currentColor",viewBox:"0 0 24 24"},se=t("path",{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"},null,-1),ae=[se],ne=F({__name:"ImageUpload",props:{imageStorageDirectory:{},label:{},defaultImageSrc:{}},emits:["fileUploaded"],setup(u,{emit:_}){const{uploadImage:i,uploadImageActions:c}=K(),{actionIsInProgress:f}=A(),y=_,m=k(""),x=o=>{const d=new FileReader;d.onload=r=>{typeof r.target.result=="string"&&(m.value=r.target.result)},d.readAsDataURL(o)},g=async o=>{let r=o.target.files;if((!r||r.length===0)&&(r=o.dataTransfer.files),!r||r.length===0)return;const v=await i(r[0],u.imageStorageDirectory);setTimeout(()=>{y("fileUploaded",{db_path:v.db_path,src:v.src})},500),x(r[0])};return(o,d)=>(s(),l("div",null,[t("label",W,w(o.label),1),t("div",X,[t("span",Y,[P(f)(P(c).uploadImage)?(s(),S(R,{key:0,class:"mx-auto h-4 w-4 text-gray-500"})):m.value?(s(),l("img",{key:1,src:m.value,class:"h-full w-full object-cover",alt:"Profile image"},null,8,Z)):o.defaultImageSrc?(s(),l("img",{key:2,src:o.defaultImageSrc,class:"h-full w-full object-cover",alt:"Profile image"},null,8,ee)):(s(),l("svg",te,ae))]),t("input",{id:"imageUpload",type:"file",accept:"image/*",class:"ml-5 rounded-md border border-gray-300 bg-white px-3 py-2 text-sm font-medium leading-4 text-gray-700 shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 hover:bg-gray-50",onChange:g},null,32)])]))}});ne.__docgenInfo={exportName:"default",displayName:"ImageUpload",description:"",tags:{},props:[{name:"imageStorageDirectory",required:!0,type:{name:"string"}},{name:"label",required:!0,type:{name:"string"}},{name:"defaultImageSrc",required:!0,type:{name:"union",elements:[{name:"string"},{name:"null"}]}}],events:[{name:"fileUploaded",type:{names:[`{\r
  db_path: string\r
  src: string\r
}`]}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/forms/ImageUpload.vue"]};const oe={class:"space-y-4"},ie={class:"flex w-full items-center gap-x-1"},re=t("p",{class:"text-sm font-medium text-gray-700"}," Roles ",-1),le={key:1,class:"relative grid grid-cols-1 gap-3 md:grid-cols-2"},ce={class:"flex h-5 items-center"},de=["id","checked","onChange"],ue={class:"ml-2"},me=["onClick"],pe=["src"],ge={class:"flex flex-col"},fe={class:"flex flex-wrap items-end gap-1"},he={class:"text-sm leading-none"},_e={class:"text-xs font-normal leading-none text-gray-400"},ye={class:"mt-1 text-left text-xs font-normal text-gray-500"},ve=F({__name:"VRoleMultiSelect",props:$({departmentFilters:{}},{selectedRoles:{},selectedRolesModifiers:{}}),emits:$(["updateSelectedRoles"],["update:selectedRoles"]),setup(u,{emit:_}){const i=M(u,"selectedRoles"),c=u,f=_,{roleActions:y,apiGetRolesByDepartments:m}=H(),{actionIsInProgress:x}=A(),g=k(!0),o=k([]),d=async()=>{try{const n=await m(c.departmentFilters.dto);n&&(o.value=n.data.roles.filter(a=>a.department.id===c.departmentFilters.department.id))}catch(n){console.log(n)}finally{g.value=!1}},r=n=>{var e,p,b;let a=-1;(e=i.value)!=null&&e.length&&(a=i.value.findIndex(V=>V.id===n.id)),a>=0?(p=i.value)==null||p.splice(a,1):(b=i.value)==null||b.push(n)},v=n=>i.value.findIndex(a=>a.id===n.id)>=0,h=k(!0);return B(async()=>{await d(),h.value=!1}),U(c.departmentFilters.dto,async()=>{h.value||(f("updateSelectedRoles"),await d())}),(n,a)=>(s(),l("div",oe,[t("div",ie,[re,P(x)(P(y).getRolesByDepartments)?(s(),S(R,{key:0,class:"h-3 w-3 text-blue-500"})):I("",!0)]),!g.value&&!o.value.length?(s(),S(T,{key:0,message:"Select a department to see roles.",class:"w-full"})):I("",!0),!g.value&&o.value.length?(s(),l("div",le,[(s(!0),l(D,null,C(o.value,e=>{var p;return s(),l("div",{key:e.id,class:"flex items-start"},[t("div",ce,[t("input",{id:e.id.toString(),type:"checkbox",checked:v(e),class:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500",onChange:b=>r(e)},null,40,de)]),t("div",ue,[t("button",{class:"flex items-start text-gray-700",onClick:N(b=>r(e),["prevent"])},[e.department.logoThumbnailSrc?(s(),l("img",{key:0,src:e.department.logoThumbnailSrc,class:"mr-1 h-4 w-4",alt:"Department Logo"},null,8,pe)):(s(),S(E,{key:1,class:"mr-1 h-4 w-4 fill-gray-400"})),t("span",ge,[t("span",fe,[t("span",he,w(e.name),1),t("span",_e," ("+w((p=e.department)==null?void 0:p.name)+") ",1)]),t("span",ye,w(e.description),1)])],8,me)])])}),128))])):I("",!0)]))}});ve.__docgenInfo={exportName:"default",displayName:"VRoleMultiSelect",description:"",tags:{},props:[{name:"departmentFilters",required:!0,type:{name:`{\r
  dto: IDepartment[]\r
  department: IDepartment\r
}`}}],events:[{name:"updateSelectedRoles"}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/inputs/VRoleMultiSelect.vue"]};const xe=["for"],be=["id","type"],Ie=F({__name:"VTextInput",props:$({label:{},type:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(u){const{generateRandomElementId:_}=z(),i=_(),c=M(u,"modelValue");return(f,y)=>(s(),l("div",null,[f.label?(s(),l("label",{key:0,for:P(i),class:"block text-sm font-medium text-gray-700"},w(f.label),9,xe)):I("",!0),j(t("input",{id:P(i),"onUpdate:modelValue":y[0]||(y[0]=m=>c.value=m),type:f.type?f.type:"text",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,8,be),[[L,c.value]])]))}});Ie.__docgenInfo={exportName:"default",displayName:"VTextInput",description:"",tags:{},props:[{name:"label",required:!1,type:{name:"string"}},{name:"type",required:!1,type:{name:"string"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/inputs/VTextInput.vue"]};const we={key:0,class:"space-y-4"},ke={class:"flex w-full items-center gap-x-1"},Pe=t("p",{class:"text-sm font-medium text-gray-700"}," Abilities ",-1),Se={key:1,class:"relative grid grid-cols-1 gap-3 md:grid-cols-2"},$e={class:"flex h-5 items-center"},Ae=["id","checked","onChange"],De={class:"ml-2"},Fe=["onClick"],Ce={key:0,class:"mr-1 flex h-5 w-5 items-center justify-center"},Me=["src"],Re={class:"flex flex-col text-left"},Ve={class:"flex flex-wrap items-end gap-1"},Be={class:"text-sm leading-none"},Ue={class:"text-xs font-normal leading-none text-gray-400"},Ne={class:"mt-1 text-left text-xs font-normal text-gray-500"},Te=F({__name:"VAbilityMultiSelect",props:$({departmentFilters:{}},{selectedAbilities:{},selectedAbilitiesModifiers:{}}),emits:$(["updateSelectedAbilities"],["update:selectedAbilities"]),setup(u,{emit:_}){const i=M(u,"selectedAbilities"),c=u,f=_,{abilityActions:y,apiGetAbilitiesByDepartments:m}=J(),{actionIsInProgress:x}=A(),g=k(!0),o=k([]),d=async()=>{try{const n=await m(c.departmentFilters.dto);n&&(o.value=n.data.abilities.filter(a=>{var e;return((e=a.department)==null?void 0:e.id)===c.departmentFilters.department.id}))}catch(n){console.log(n)}finally{g.value=!1}},r=n=>{var e,p,b;let a=-1;(e=i.value)!=null&&e.length&&(a=i.value.findIndex(V=>V.id===n.id)),a>=0?(p=i.value)==null||p.splice(a,1):(b=i.value)==null||b.push(n)},v=n=>i.value.findIndex(a=>a.id===n.id)>=0,h=k(!0);return B(async()=>{await d(),h.value=!1}),U(c.departmentFilters.dto,async()=>{h.value||(f("updateSelectedAbilities"),await d())}),(n,a)=>o.value.length||g.value?(s(),l("div",we,[t("div",ke,[Pe,P(x)(P(y).getAbilitiesByDepartments)?(s(),S(R,{key:0,class:"h-3 w-3 text-blue-500"})):I("",!0)]),!g.value&&!o.value.length?(s(),S(T,{key:0,message:"Select a department to see abilities.",class:"w-full"})):I("",!0),!g.value&&o.value.length?(s(),l("div",Se,[(s(!0),l(D,null,C(o.value,e=>{var p;return s(),l("div",{key:e.id,class:"flex items-start"},[t("div",$e,[t("input",{id:e.id.toString(),type:"checkbox",checked:v(e),class:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500",onChange:b=>r(e)},null,40,Ae)]),t("div",De,[t("button",{class:"flex items-start text-gray-700",onClick:N(b=>r(e),["prevent"])},[e.iconUrl?(s(),l("span",Ce,[t("img",{src:e.iconUrl,alt:"Ability Icon"},null,8,Me)])):(s(),S(E,{key:1,class:"mr-1 h-4 w-4"})),t("span",Re,[t("span",Ve,[t("span",Be,w(e.name),1),t("span",Ue," ("+w((p=e.department)==null?void 0:p.name)+") ",1)]),t("span",Ne,w(e.description),1)])],8,Fe)])])}),128))])):I("",!0)])):I("",!0)}});Te.__docgenInfo={exportName:"default",displayName:"VAbilityMultiSelect",description:"",tags:{},props:[{name:"departmentFilters",required:!0,type:{name:`{\r
  dto: IDepartment[]\r
  department: IDepartment\r
}`}}],events:[{name:"updateSelectedAbilities"}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/inputs/VAbilityMultiSelect.vue"]};const q=O("permissions",()=>{const u=k([]);function _(c){u.value=c}function i(){u.value=[]}return{setPermissions:_,permissions:u,clearPermissions:i}});function qe(){const{apiClient:u}=G(),{addToActionsInProgress:_,removeFromActionsInProgress:i,processActionError:c,resetActionsInError:f}=A(),{setPermissions:y}=q(),{permissions:m}=Q(q()),x={getPermissionsByDepartments:{id:"getPermissionsByDepartments",successMessage:"Permissions retrieved successfully.",errorMessage:"There was a problem retrieving the permissions."}};return{apiGetPermissionsByDepartments:async r=>{f(),_(x.getPermissionsByDepartments);try{const v=[];r==null||r.forEach(n=>{v.push(n.id)});const h=await u.post("/api/permissions/get-by-departments",{departmentIds:v});return i(x.getPermissionsByDepartments),h.data.permissions}catch(v){console.log(v),c(x.getPermissionsByDepartments,v)}},storeGetPermissions:()=>m.value,storeSetPermissions:r=>{y(r)},permissionActions:x}}const Ge={class:"space-y-4"},Ee={class:"flex w-full items-center gap-x-1"},je=t("p",{class:"text-sm font-medium text-gray-700"}," Permissions ",-1),Le={key:1,class:"relative grid grid-cols-1 gap-3 md:grid-cols-2"},He=["textContent"],ze=["textContent"],Je={class:"flex h-5 items-center"},Oe=["id","checked","onChange"],Qe=["onClick"],Ke=F({__name:"VPermissionMultiSelect",props:$({departmentFilters:{}},{selectedPermissions:{},selectedPermissionsModifiers:{}}),emits:$(["clearSelectedPermissions"],["update:selectedPermissions"]),setup(u,{emit:_}){const i=M(u,"selectedPermissions"),c=u,f=_,{permissionActions:y,apiGetPermissionsByDepartments:m}=qe(),{actionIsInProgress:x}=A(),g=k(!0),o=k([]),d=async()=>{try{o.value=await m(c.departmentFilters)}catch(h){console.log(h)}finally{g.value=!1}},r=(h,n)=>{var e,p;const a=i.value.findIndex(b=>b.permission.id===h.id&&b.department.id===n.id);a>=0?(e=i.value)==null||e.splice(a,1):(p=i.value)==null||p.push({permission:h,department:n})},v=(h,n)=>{var a;return(a=i.value)==null?void 0:a.some(e=>e.permission.id===h.id&&e.department.id===n.id)};return B(async()=>{await d()}),U(c.departmentFilters,async()=>{f("clearSelectedPermissions"),o.value=[],await d()}),(h,n)=>(s(),l("div",Ge,[t("div",Ee,[je,P(x)(P(y).getPermissionsByDepartments)?(s(),S(R,{key:0,class:"h-3 w-3 text-blue-500"})):I("",!0)]),!g.value&&!o.value.length?(s(),S(T,{key:0,message:"Select a department to see permissions.",class:"w-full"})):I("",!0),!g.value&&o.value.length?(s(),l("div",Le,[(s(!0),l(D,null,C(o.value,a=>(s(),l("div",{key:a.id},[t("p",{class:"text-sm text-gray-700",textContent:w(a.label)},null,8,He),t("p",{class:"mb-2 text-xs text-gray-500",textContent:w(a.description)},null,8,ze),(s(!0),l(D,null,C(a.departments,e=>(s(),l("div",{key:e.id,class:"flex items-center"},[h.departmentFilters.some(p=>p.id===e.id)?(s(),l(D,{key:0},[t("div",Je,[t("input",{id:e.id.toString(),type:"checkbox",checked:v(a,e),class:"h-4 w-4 cursor-pointer rounded border-gray-300 text-blue-600 focus:ring-blue-500",onChange:p=>r(a,e)},null,40,Oe)]),t("button",{class:"ml-2 text-xs text-gray-700",onClick:N(p=>r(a,e),["prevent"])},w(e.name),9,Qe)],64)):I("",!0)]))),128))]))),128))])):I("",!0)]))}});Ke.__docgenInfo={exportName:"default",displayName:"VPermissionMultiSelect",description:"",tags:{},props:[{name:"departmentFilters",required:!0,type:{name:"Array",elements:[{name:"IDepartment"}]}}],events:[{name:"clearSelectedPermissions"}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/inputs/VPermissionMultiSelect.vue"]};export{ne as _,Ie as a,ve as b,Te as c,Ke as d};
