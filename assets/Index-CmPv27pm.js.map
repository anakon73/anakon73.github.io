{"version":3,"file":"Index-CmPv27pm.js","sources":["../../src/pages/assessments/Index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onUnmounted } from 'vue'\nimport { storeToRefs } from 'pinia'\nimport MainContent from '@/shared/ui/layout/MainContent.vue'\nimport { useUi } from '@/shared/lib/composables/useUi'\nimport ProgressSpinner from '@/shared/ui/ProgressSpinner.vue'\nimport { useAssessment } from '@/shared/api/useAssessment'\nimport { AppPermissions } from '@/shared/types/enums/permissions/permissions'\nimport { useUiStore } from '@/shared/lib/composables/ui'\nimport { useAuth } from '@/shared/api/useAuth'\nimport { useAssessmentStore } from '@/shared/api/stores/assessment'\nimport VDataFilters from '@/shared/ui/inputs/VDataFilters.vue'\nimport type { IDataFilters } from '@/shared/types/inputs/IDataFilters'\n\nconst {\n  assessmentActions,\n  apiGetAssessmentsByDepartmentId,\n} = useAssessment()\n\nconst { actionIsInProgress } = useUi()\nconst { storeFilterState } = storeToRefs(useUiStore())\nconst { storeSetFilterState } = useUiStore()\n\nconst { storeAssessments } = storeToRefs(useAssessmentStore())\nconst { storeSetAssessments, storeClearAssessments } = useAssessmentStore()\nconst { userHasPermissionInDepartment } = useAuth()\n\nconst handleFilterStateUpdate = async (newFilterState: IDataFilters) => {\n  storeSetFilterState(newFilterState)\n\n  if (storeFilterState.value.selectedDepartment === null) {\n    return\n  }\n\n  const assessments = await apiGetAssessmentsByDepartmentId(storeFilterState.value.selectedDepartment.id)\n\n  if (assessments) {\n    storeSetAssessments(assessments)\n  }\n}\nonUnmounted(() => {\n  storeClearAssessments()\n})\n</script>\n\n<template>\n  <MainContent main-content-title=\"Manage Assessments\">\n    <div class=\"mt-12 flex w-full justify-end\">\n      <RouterLink\n        v-if=\"storeFilterState.selectedDepartment && userHasPermissionInDepartment(\n          AppPermissions.MANAGE_ASSESSMENTS,\n          storeFilterState.selectedDepartment,\n        )\"\n        :to=\"{ name: $Routes.AssessmentCreate }\"\n        class=\"block w-1/2 rounded-md bg-blue-600 px-3 py-1.5 text-center text-sm font-semibold leading-6 text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 hover:bg-blue-500 md:w-48\"\n      >\n        Add Assessment\n      </RouterLink>\n    </div>\n\n    <VDataFilters\n      :department-permissions-required=\"[\n        AppPermissions.VIEW_ASSESSMENTS,\n      ]\"\n      filter-by-departments\n      @filter-state-updated=\"handleFilterStateUpdate\"\n    />\n\n    <div class=\"flex flex-col pb-4\">\n      <div class=\"flow-root md:mt-8\">\n        <div class=\"overflow-x-auto\">\n          <div class=\"inline-block min-w-full py-2 align-middle\">\n            <div\n              v-if=\"storeFilterState.selectedDepartment === null || actionIsInProgress(assessmentActions.getAssessmentsByDepartmentId)\"\n              class=\"flex h-[50px] items-center justify-center rounded border border-gray-100 bg-gray-50 shadow\"\n            >\n              <ProgressSpinner class=\"h-5 w-5 text-blue-600\" />\n            </div>\n\n            <table\n              v-else\n              class=\"min-w-full divide-y divide-gray-300 rounded border border-gray-100 bg-white shadow\"\n            >\n              <thead>\n                <tr>\n                  <th scope=\"col\" class=\"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                    Assessment Name\n                  </th>\n                  <th scope=\"col\" colspan=\"2\" class=\"bg-gray-50 px-3 py-3.5\" />\n                </tr>\n              </thead>\n              <tbody class=\"divide-y divide-gray-200\">\n                <tr\n                  v-for=\"assessment in storeAssessments\"\n                  :key=\"assessment.id\"\n                >\n                  <td class=\"flex items-center whitespace-nowrap p-3 text-sm font-medium text-gray-900\">\n                    {{ assessment.name }}\n                  </td>\n                  <td class=\"relative whitespace-nowrap p-3 text-right text-sm font-medium\">\n                    <RouterLink\n                      :to=\"{\n                        name: $Routes.AssessmentEdit,\n                        params: { assessmentId: assessment.id },\n                      }\"\n                      class=\"text-blue-600 hover:text-blue-900\"\n                    >\n                      View\n                    </RouterLink>\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </MainContent>\n</template>\n"],"names":["assessmentActions","apiGetAssessmentsByDepartmentId","useAssessment","actionIsInProgress","useUi","storeFilterState","storeToRefs","useUiStore","storeSetFilterState","storeAssessments","useAssessmentStore","storeSetAssessments","storeClearAssessments","userHasPermissionInDepartment","useAuth","handleFilterStateUpdate","newFilterState","assessments","onUnmounted"],"mappings":"soHAcM,KAAA,CACJ,kBAAAA,EACA,gCAAAC,GACEC,EAAc,EAEZ,CAAE,mBAAAC,GAAuBC,IACzB,CAAE,iBAAAC,CAAqB,EAAAC,EAAYC,EAAY,CAAA,EAC/C,CAAE,oBAAAC,GAAwBD,IAE1B,CAAE,iBAAAE,CAAqB,EAAAH,EAAYI,EAAoB,CAAA,EACvD,CAAE,oBAAAC,EAAqB,sBAAAC,CAAsB,EAAIF,EAAmB,EACpE,CAAE,8BAAAG,GAAkCC,IAEpCC,EAA0B,MAAOC,GAAiC,CAGlE,GAFJR,EAAoBQ,CAAc,EAE9BX,EAAiB,MAAM,qBAAuB,KAChD,OAGF,MAAMY,EAAc,MAAMhB,EAAgCI,EAAiB,MAAM,mBAAmB,EAAE,EAElGY,GACFN,EAAoBM,CAAW,CACjC,EAEF,OAAAC,EAAY,IAAM,CACMN,GAAA,CACvB"}