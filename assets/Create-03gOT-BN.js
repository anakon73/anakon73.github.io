import{e as H,j as h,g as q,q as P,o as i,A as b,B as v,E as W,l as e,b as g,J as a,S as m,k as l,H as r,G as d,u as n,F as c,P as p,D as U,T as V,N as J}from"./vue.esm-bundler-CYPfFjdk.js";import{s as K,u as Y,L as O,I as L,G as C,f as D,C as F,E as u,g as R,h as Q,j as X,k as Z,l as ee}from"./schemas-74JEr9Jm.js";import{R as te}from"./RightDrawer-Lpr6admO.js";import{a as se,e as oe}from"./preview-D0Pi-YKn.js";import{u as ie}from"./useIncident-6dw9YxXc.js";import{I as le}from"./IconClose-tbzieUCA.js";import{P as ne}from"./ProgressSpinner-lCLkagxy.js";import{u as ae}from"./useHelpers-Uc_HlRzD.js";import{_ as re,a as de}from"./ActionErrorAlert--bGVRXV4.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./IconTickMarkCircle-2_sKm8Jk.js";const ce={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},me={class:"sticky top-0 z-10 flex w-full items-center justify-end bg-white p-6"},ue=e("div",{class:"mb-6"},[e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," Create Incident Report. "),e("p",{class:"mt-1 text-sm text-gray-500"}," Use the form below to create a new Incident Report. ")],-1),_e={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},pe={class:"sm:col-span-3"},fe=e("label",{for:"departure_name",class:"block text-sm font-medium text-gray-700"}," Name of Departure ",-1),be={class:"mt-1"},ve={class:"sm:col-span-3"},ge=e("label",{for:"departure_date_and_time",class:"block text-sm font-medium text-gray-700"}," Departure Date and Time ",-1),xe={class:"mt-1"},ye={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},he={class:"sm:col-span-3"},we=e("label",{for:"incident_level",class:"block text-sm font-medium text-gray-700"}," Incident Level ",-1),ke={class:"mt-1"},Ie={class:"sm:col-span-3"},Ue=e("label",{for:"group_size",class:"block text-sm font-medium text-gray-700"}," Group Size ",-1),Ve={class:"mt-1"},Le={class:"sm:col-span-3"},Ce=e("label",{for:"staff_involved_id",class:"block text-sm font-medium text-gray-700"}," Staff Involved ",-1),De={class:"mt-1"},Fe=["value"],Re={class:"sm:col-span-3"},Se=e("label",{for:"group_direction",class:"block text-sm font-medium text-gray-700"}," Was the group ascending or descending? ",-1),Ee={class:"mt-1"},Me={class:"sm:col-span-3"},Te=e("label",{for:"incident_master_location",class:"block text-sm font-medium text-gray-700"}," Incident Location ",-1),Ne={class:"mt-1"},$e={class:"sm:col-span-3"},ze=e("label",{for:"incident_location",class:"block text-sm font-medium text-gray-700"}," Â  ",-1),Ae={class:"mt-1"},Ge={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},je={class:"sm:col-span-3"},Be=e("label",{for:"client_name",class:"block text-sm font-medium text-gray-700"}," Client Name ",-1),He={class:"mt-1"},qe={class:"sm:col-span-3"},Pe=e("label",{for:"client_age",class:"block text-sm font-medium text-gray-700"}," Client Age ",-1),We={class:"mt-1"},Je={class:"sm:col-span-3"},Ke=e("label",{for:"client_gender",class:"block text-sm font-medium text-gray-700"}," Client Gender ",-1),Ye={class:"mt-1"},Oe={class:"sm:col-span-3"},Qe=e("label",{for:"client_ability",class:"block text-sm font-medium text-gray-700"}," Client's Fitness/Ability ",-1),Xe={class:"mt-1"},Ze={class:"sm:col-span-6"},et=e("label",{for:"client_email",class:"block text-sm font-medium text-gray-700"}," Client Email ",-1),tt={class:"mt-1"},st={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-5"},ot={class:"sm:col-span-1"},it=e("label",{for:"environmental_rain",class:"block text-sm font-medium text-gray-700"}," Rain ",-1),lt={class:"mt-1"},nt={class:"sm:col-span-1"},at=e("label",{for:"environmental_wind",class:"block text-sm font-medium text-gray-700"}," Wind ",-1),rt={class:"mt-1"},dt={class:"sm:col-span-1"},ct=e("label",{for:"environmental_temp",class:"block text-sm font-medium text-gray-700"}," Temp ",-1),mt={class:"mt-1"},ut={class:"sm:col-span-1"},_t=e("label",{for:"environmental_ice",class:"block text-sm font-medium text-gray-700"}," Ice ",-1),pt={class:"mt-1"},ft={class:"sm:col-span-1"},bt=e("label",{for:"environmental_forecast",class:"block text-sm font-medium text-gray-700"}," Forecast ",-1),vt={class:"mt-1"},gt={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},xt={class:"sm:col-span-6"},yt=e("label",{for:"incident_description",class:"block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"}," Incident Description ",-1),ht={class:"mt-1 sm:col-span-2"},wt=e("p",{class:"mt-2 text-sm text-gray-500"}," Enter as much information about the incident as possible... ",-1),kt={class:"sm:col-span-6"},It=e("label",{for:"rope_rescue_details",class:"block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"}," Rope Rescue Details ",-1),Ut={class:"mt-1 sm:col-span-2"},Vt=e("p",{class:"mt-2 text-sm text-gray-500"}," If a rope rescue was involved, describe the details... ",-1),Lt={class:"sm:col-span-6"},Ct=e("label",{for:"first_aid_details",class:"block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"}," First Aid Details ",-1),Dt={class:"mt-1 sm:col-span-2"},Ft=e("p",{class:"mt-2 text-sm text-gray-500"}," Describe in detail any first aid administered... ",-1),Rt={class:"sm:col-span-6"},St=e("label",{for:"evacuation_details",class:"block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"}," Evacuation Details ",-1),Et={class:"mt-1 sm:col-span-2"},Mt=e("p",{class:"mt-2 text-sm text-gray-500"}," If an evacuation was required, describe the details... ",-1),Tt={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},Nt={class:"sm:col-span-6"},$t=e("label",{for:"root_cause",class:"block text-sm font-medium text-gray-700"}," Root Cause ",-1),zt=e("p",{class:"mt-2 text-sm text-gray-500"}," What would you describe as the main cause for this incident? ",-1),At={class:"mt-1"},Gt={class:"relative pt-5"},jt={class:"flex items-center justify-end"},Bt={class:"flex items-center"},Ht={key:0},qt=H({__name:"Create",setup(Pt){const{validateForm:S,actionIsInProgress:E,actionIsInError:M,actionIsInSuccess:T}=se(),{getCurrentDateInYmdFormat:w}=ae(),k=h(null),{createIncident:N,incidentActions:f}=ie(),{fetchAndStoreUsersIndex:$}=oe(),{storeUsers:I}=K(Y()),z=()=>{const _=new Date,o=_.getHours(),y=_.getMinutes();return`${o}:${y}`},A=`${w()}T${z()}`,G=`${w()}T23:59`,s=h({name_of_departure:"Glacier Wonders",incident_master_location:O.Skaftafell,incident_location:"Kings Landing",date_of_departure:A,incident_level:L.NearMiss,group_size:1,staff_member_involved_id:0,group_ascending_or_descending:C.Asc,client_name:"",client_age:"25-29",client_gender:D.Male,client_ability:F.Medium,client_email:"",rain:u.Low,wind:u.Low,temp:u.Low,ice:u.Low,forecast:u.Low,incident_description:"",rope_rescue_details:"",first_aid_details:"",evacuation_details:"",root_cause:R[0]}),x=h(Q),j=q(()=>x.value.find(_=>_.masterLocation===s.value.incident_master_location).locations);P(async()=>{await $(1,!1),s.value.staff_member_involved_id=I.value[0].id});const B=_=>{_.target instanceof HTMLSelectElement&&(s.value.incident_master_location=_.target.value,s.value.incident_location=x.value.find(o=>o.masterLocation===s.value.incident_master_location).locations[0])};return(_,o)=>{const y=W("RouterLink");return i(),b(te,null,{default:v(()=>[e("div",ce,[e("div",me,[g(y,{to:{name:_.$Routes.Incidents}},{default:v(()=>[g(le,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"])]),e("form",{id:"create_incident_form",ref_key:"createIncidentFormElement",ref:k,class:"space-y-8 divide-y divide-gray-200 px-6 md:px-12"},[ue,e("div",_e,[e("div",pe,[fe,e("div",be,[a(e("select",{id:"departure_name","onUpdate:modelValue":o[0]||(o[0]=t=>s.value.name_of_departure=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(X),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.name_of_departure]])])]),e("div",ve,[ge,e("div",xe,[a(e("input",{id:"departure_date_and_time","onUpdate:modelValue":o[1]||(o[1]=t=>s.value.date_of_departure=t),type:"datetime-local",max:G,class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.date_of_departure]])])])]),e("div",ye,[e("div",he,[we,e("div",ke,[a(e("select",{id:"incident_level","onUpdate:modelValue":o[2]||(o[2]=t=>s.value.incident_level=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(L),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.incident_level]])])]),e("div",Ie,[Ue,e("div",Ve,[a(e("select",{id:"group_size","onUpdate:modelValue":o[3]||(o[3]=t=>s.value.group_size=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(Z),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.group_size,void 0,{number:!0}]])])]),e("div",Le,[Ce,e("div",De,[a(e("select",{id:"staff_involved_id","onUpdate:modelValue":o[4]||(o[4]=t=>s.value.staff_member_involved_id=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},[(i(!0),l(c,null,r(n(I),t=>(i(),l("option",{key:t.id,value:t.id},d(t.fullName),9,Fe))),128))],512),[[m,s.value.staff_member_involved_id]])])]),e("div",Re,[Se,e("div",Ee,[a(e("select",{id:"group_direction","onUpdate:modelValue":o[5]||(o[5]=t=>s.value.group_ascending_or_descending=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(C),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.group_ascending_or_descending]])])]),e("div",Me,[Te,e("div",Ne,[e("select",{id:"incident_master_location",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",onChange:B},[(i(!0),l(c,null,r(x.value,t=>(i(),l("option",{key:t.masterLocation},d(t.masterLocation),1))),128))],32)])]),e("div",$e,[ze,e("div",Ae,[a(e("select",{id:"incident_location","onUpdate:modelValue":o[6]||(o[6]=t=>s.value.incident_location=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(j.value,t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.incident_location]])])])]),e("div",Ge,[e("div",je,[Be,e("div",He,[a(e("input",{id:"client_name","onUpdate:modelValue":o[7]||(o[7]=t=>s.value.client_name=t),type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.client_name]])])]),e("div",qe,[Pe,e("div",We,[a(e("select",{id:"client_age","onUpdate:modelValue":o[8]||(o[8]=t=>s.value.client_age=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(ee),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.client_age]])])]),e("div",Je,[Ke,e("div",Ye,[a(e("select",{id:"client_gender","onUpdate:modelValue":o[9]||(o[9]=t=>s.value.client_gender=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(D),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.client_gender]])])]),e("div",Oe,[Qe,e("div",Xe,[a(e("select",{id:"client_ability","onUpdate:modelValue":o[10]||(o[10]=t=>s.value.client_ability=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(F),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.client_ability]])])]),e("div",Ze,[et,e("div",tt,[a(e("input",{id:"client_email","onUpdate:modelValue":o[11]||(o[11]=t=>s.value.client_email=t),type:"email",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.client_email]])])])]),e("div",st,[e("div",ot,[it,e("div",lt,[a(e("select",{id:"environmental_rain","onUpdate:modelValue":o[12]||(o[12]=t=>s.value.rain=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(u),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.rain]])])]),e("div",nt,[at,e("div",rt,[a(e("select",{id:"environmental_wind","onUpdate:modelValue":o[13]||(o[13]=t=>s.value.wind=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(u),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.wind]])])]),e("div",dt,[ct,e("div",mt,[a(e("select",{id:"environmental_temp","onUpdate:modelValue":o[14]||(o[14]=t=>s.value.temp=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(u),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.temp]])])]),e("div",ut,[_t,e("div",pt,[a(e("select",{id:"environmental_ice","onUpdate:modelValue":o[15]||(o[15]=t=>s.value.ice=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(u),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.ice]])])]),e("div",ft,[bt,e("div",vt,[a(e("select",{id:"environmental_forecast","onUpdate:modelValue":o[16]||(o[16]=t=>s.value.forecast=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(u),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.forecast]])])])]),e("div",gt,[e("div",xt,[yt,e("div",ht,[a(e("textarea",{id:"incident_description","onUpdate:modelValue":o[17]||(o[17]=t=>s.value.incident_description=t),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[p,s.value.incident_description]]),wt])]),e("div",kt,[It,e("div",Ut,[a(e("textarea",{id:"rope_rescue_details","onUpdate:modelValue":o[18]||(o[18]=t=>s.value.rope_rescue_details=t),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.rope_rescue_details]]),Vt])]),e("div",Lt,[Ct,e("div",Dt,[a(e("textarea",{id:"first_aid_details","onUpdate:modelValue":o[19]||(o[19]=t=>s.value.first_aid_details=t),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.first_aid_details]]),Ft])]),e("div",Rt,[St,e("div",Et,[a(e("textarea",{id:"evacuation_details","onUpdate:modelValue":o[20]||(o[20]=t=>s.value.evacuation_details=t),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[p,s.value.evacuation_details]]),Mt])])]),e("div",Tt,[e("div",Nt,[$t,zt,e("div",At,[a(e("select",{id:"root_cause","onUpdate:modelValue":o[21]||(o[21]=t=>s.value.root_cause=t),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(i(!0),l(c,null,r(n(R),t=>(i(),l("option",{key:t},d(t),1))),128))],512),[[m,s.value.root_cause]])])])]),e("div",Gt,[e("div",jt,[g(V,{name:"alert"},{default:v(()=>[n(T)(n(f).createIncident)?(i(),b(re,{key:0,action:n(f).createIncident},null,8,["action"])):U("",!0)]),_:1}),g(V,{name:"alert"},{default:v(()=>[n(M)(n(f).createIncident)?(i(),b(de,{key:0,action:n(f).createIncident},null,8,["action"])):U("",!0)]),_:1}),e("div",Bt,[e("button",{class:"ml-3 inline-flex h-9 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700",onClick:o[22]||(o[22]=J(t=>n(S)(k.value,()=>n(N)(s.value)),["prevent"]))},[n(E)(n(f).createIncident)?(i(),b(ne,{key:1,class:"h-3 w-3 text-white"})):(i(),l("span",Ht," Save "))])])])])],512)])]),_:1})}}});qt.__docgenInfo={exportName:"default",displayName:"Create",description:"",tags:{},sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/incidents/Create.vue"]};export{qt as default};
