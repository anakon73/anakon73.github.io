import{u as m,s as f}from"./schemas-74JEr9Jm.js";import{u as h,a as y}from"./preview-D0Pi-YKn.js";import{R as g}from"./routes-WhYxSpGG.js";function C(){const{apiClient:a}=h(),{storeSetUser:i}=m(),{addToActionsInProgress:u,removeFromActionsInProgress:c,processActionError:l,resetActionsInError:p}=y(),{user:s}=f(m()),n={attemptLogin:{id:"attemptLogin",successMessage:"Successfully logged in.",errorMessage:"There was an error logging in."},logout:{id:"logout",successMessage:"Successfully logged out.",errorMessage:"There was an error logging out."}};return{authActions:n,user:s,attemptLogin:async(e,t,r)=>{p(),u(n.attemptLogin);try{await a.get("/sanctum/csrf-cookie");const o=await a.post("/api/login",{email:e,password:t});o&&(i(o.data.user),await r.push({name:g.Schedule})),c(n.attemptLogin)}catch(o){console.log(o),l(n.attemptLogin,o)}},logout:async e=>{u(n.logout);try{await a.post("/api/logout"),i(null),await e.push({name:g.Login}),c(n.logout)}catch(t){l(n.logout,t)}},setUserToCurrentlyAuthenticatedUser:async()=>{try{const e=await a.get("/api/user");i(e.data.user)}catch{i(null)}return s},userHasAbility:e=>s.value?s.value.allAbilities.some(t=>t.slug===e):!1,userHasPermissionInSomeDepartment:e=>s.value?s.value.permissions.some(t=>{try{return t.permission.slug===e}catch{return t.permissions.includes(e)}}):!1,userHasSomePermissionsInDepartment:(e,t)=>s.value?s.value.permissions.some(r=>{try{return e.includes(r.permission.slug)&&r.department.id===t.id}catch{return e.some(d=>r.permissions.includes(d)&&r.department.id===t.id)}}):!1,userHasPermissionInDepartment:(e,t)=>{if(s.value)try{return s.value.permissions.some(r=>r.permission.slug===e&&r.department.id===t.id)}catch{return s.value.permissions.some(o=>o.permissions.includes(e)&&o.department.id===t.id)}return!1}}}export{C as u};
