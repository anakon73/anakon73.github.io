import{e as R,R as J,Q,j as D,q as $,w as C,o as l,k as r,J as n,S as A,l as e,F as M,H as L,C as I,u as i,b as _,D as x,G as P,z as X,A as y,B,E as Y,P as b,T as F,N as K}from"./vue.esm-bundler-CYPfFjdk.js";import{R as Z}from"./RightDrawer-Lpr6admO.js";import{a as j,A as ee}from"./preview-D0Pi-YKn.js";import{I as te}from"./IconClose-tbzieUCA.js";import{P as O}from"./ProgressSpinner-lCLkagxy.js";import{u as oe,a as se}from"./useExperience-j1XTukVo.js";import{u as ie}from"./useExperienceLocation-WT3dP7yS.js";import{_ as ae,a as le}from"./ActionErrorAlert--bGVRXV4.js";import{_ as re}from"./VDepartmentSelect-fFgtBnGn.js";import{u as G}from"./useOperationalBase-kvvO22e1.js";import{p as ne}from"./schemas-74JEr9Jm.js";import{i as de}from"./PToggle-mLVcOzrp.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./vue-router-E7v71uM3.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./index-LmGWO5sK.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./models-qWR1FMGP.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./routes-WhYxSpGG.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./IconTickMarkCircle-2_sKm8Jk.js";import"./useDepartment-RZahlhen.js";import"./useAuth-8d_1_S6I.js";const ue=["disabled"],me=["value"],ce={key:0,class:"absolute inset-0 flex items-center justify-center"},H=R({__name:"VOperationalBaseSelect",props:J({selectedDepartmentId:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(h){const{actionIsInProgress:k,resetActionsInError:w,resetActionsInSuccess:S,addToActionsInProgress:m,removeFromActionsInProgress:U}=j(),{operationalBaseActions:v,apiGetOperationalBasesByDepartmentId:p}=G(),g=Q(h,"modelValue"),f=D([]),E=async()=>{w(),S(),m(v.getOperationalBasesByDepartments);const d=await p(h.selectedDepartmentId);if(d)return U(v.getOperationalBasesByDepartments),d.data.operationalBases};return $(async()=>{const d=await E();d&&(f.value=d)}),C(()=>h.selectedDepartmentId,async d=>{if(d){const c=await E();c&&(f.value=c,g.value=f.value[0].id)}}),(d,c)=>(l(),r("div",{class:I(["relative",[{"cursor-not-allowed opacity-50":i(k)(i(v).getOperationalBaseById)},{"cursor-not-allowed opacity-50":i(k)(i(v).getOperationalBasesByDepartments)}]])},[n(e("select",{"onUpdate:modelValue":c[0]||(c[0]=u=>g.value=u),class:I(["mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:min-w-[250px] sm:text-sm",{"bg-gray-200 bg-none":f.value.length===1}]),disabled:f.value.length===1},[(l(!0),r(M,null,L(f.value,u=>(l(),r("option",{key:u.id,value:u.id},P(u.name),9,me))),128))],10,ue),[[A,g.value]]),i(k)(i(v).getOperationalBaseById)?(l(),r("div",ce,[_(O,{class:"h-4 w-4 text-blue-500"})])):x("",!0)],2))}});H.__docgenInfo={exportName:"default",displayName:"VOperationalBaseSelect",description:"",tags:{},props:[{name:"selectedDepartmentId",required:!0,type:{name:"number"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/shared/ui/inputs/VOperationalBaseSelect.vue"]};const pe={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},fe={class:"sticky top-0 z-[9999999] flex w-full items-center justify-end bg-white p-6"},be=e("div",{class:"mb-6"},[e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," Edit Experience. "),e("p",{class:"mt-1 text-sm text-gray-500"}," Use the form below to edit the experience. ")],-1),_e={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6"},ve=e("p",{class:"mb-1 block text-sm font-medium text-gray-700"}," Department ",-1),xe=e("p",{class:"mb-1 block text-sm font-medium text-gray-700"}," Operational Base ",-1),ge=e("label",{for:"experience_title",class:"block text-sm font-medium text-gray-700"}," Title ",-1),ye={class:"mt-1"},he=e("label",{for:"experience_description",class:"block text-sm font-medium text-gray-700"}," Description ",-1),ke={class:"mt-1"},we={class:"grid grid-cols-1 gap-x-2 gap-y-6 sm:grid-cols-2"},Be=e("label",{for:"bokun_id",class:"block text-sm font-medium text-gray-700"}," Bókun ID ",-1),Ie={class:"mt-1"},Ee=e("label",{for:"bokun_product_code",class:"block text-sm font-medium text-gray-700"}," Bókun Product Code ",-1),Ve={class:"mt-1"},De=e("label",{for:"customised_start_time",class:"block text-sm font-medium text-gray-700"}," Customised Start Time? ",-1),Ae={class:"mt-1"},Me=e("option",{value:!0}," Yes ",-1),Oe=e("option",{value:!1}," No ",-1),Se=[Me,Oe],Ue=e("label",{for:"min_age",class:"block text-sm font-medium text-gray-700"}," Minimum Age ",-1),Ce={class:"mt-1"},Le=e("label",{for:"difficulty",class:"block text-sm font-medium text-gray-700"}," Difficulty ",-1),Pe={class:"mt-1"},qe=e("label",{for:"distance_hiked_in_meters",class:"block text-sm font-medium text-gray-700"}," Distance Hiked (m) ",-1),Te={class:"mt-1"},Ne=e("label",{for:"distance_driven_in_meters",class:"block text-sm font-medium text-gray-700"}," Distance Driven (m) ",-1),Fe={class:"mt-1"},Re=e("label",{for:"experience_location_id",class:"block text-sm font-medium text-gray-700"}," Experience Location ",-1),$e={class:"relative mt-1"},je=["disabled"],Ge=["value"],He={key:0,class:"absolute inset-0 flex items-center justify-center"},ze=e("label",{for:"duration_in_minutes",class:"block text-sm font-medium text-gray-700"}," Duration (minutes) ",-1),We={class:"mt-1"},Je=e("label",{for:"allow_vehicles",class:"block text-sm font-medium text-gray-700"}," Allow Vehicles ",-1),Qe={class:"mt-1"},Xe={key:0,class:"relative pt-5"},Ye={class:"flex items-center justify-end"},Ke={class:"flex items-center"},Ze={key:0},et=R({__name:"Edit",props:{experienceId:{}},setup(h){const k=h,{experienceId:w}=X(k),{validateForm:S,actionIsInProgress:m,actionIsInError:U,actionIsInSuccess:v}=j(),{experienceActions:p,getExperienceById:g,editExperience:f}=oe(),{operationalBaseActions:E}=G(),{storeAddExperience:d}=se(),{fetchAndStoreExperienceLocationsByOperationalBaseIdIndex:c,getAllExperienceLocationsFromStore:u,experienceLocationActions:V}=ie(),q=D(null),T=D({selectedDepartment:null,selectedOperationalBase:null,selectedRole:null,selectedMonth:"",selectedDate:""}),t=D(null),z=async()=>{await S(q.value,async()=>{if(!t.value)return;const s=await f(t.value);s&&T.value.selectedOperationalBase&&s.operationalBase.id===T.value.selectedOperationalBase.id&&d(s)})},N=s=>{t.value={id:s.id,department:s.operationalBase.department,operationalBase:s.operationalBase,experienceLocation:s.experienceLocation,title:s.title,description:s.description,bokunId:s.bokunId,bokunProductCode:s.bokunProductCode,customisedStartTime:s.customisedStartTime,minAge:s.minAge,difficulty:s.difficulty,distanceHikedInMeters:s.distanceHikedInMeters,distanceDrivenInMeters:s.distanceDrivenInMeters,durationInMinutes:s.durationInMinutes,allowVehicles:s.allowVehicles}};return $(async()=>{if(w.value){const s=await g(w.value.toString());s&&(await c(s.operationalBase.id),N(s))}}),C(w,async s=>{const a=await g(s.toString());await c(a.operationalBase.id),N(a)}),C(()=>{var s;return(s=t.value)==null?void 0:s.operationalBase},async s=>{s&&(await c(s.id),t.value&&(t.value.experienceLocation=u()[0]))},{deep:!0}),(s,a)=>{const W=Y("RouterLink");return l(),y(Z,null,{default:B(()=>[e("div",pe,[e("div",fe,[i(m)(i(p).editExperience)||i(m)(i(V).getExperienceLocationById)||i(m)(i(V).getAllExperienceLocationsByOperationalBaseId)||i(m)(i(E).getOperationalBasesByDepartments)?(l(),y(O,{key:0,class:"h-5 w-5 text-blue-500"})):(l(),y(W,{key:1,to:{name:s.$Routes.Experiences}},{default:B(()=>[_(te,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"]))]),t.value?(l(),r("form",{key:0,id:"edit_experience_form",ref_key:"editExperienceFormElement",ref:q,class:"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12"},[be,e("div",_e,[e("div",null,[ve,_(re,{modelValue:t.value.operationalBase.department,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.operationalBase.department=o),"department-permissions-required":[i(ee).MANAGE_EXPERIENCES]},null,8,["modelValue","department-permissions-required"])]),e("div",null,[xe,_(H,{modelValue:t.value.operationalBase.id,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.operationalBase.id=o),"selected-department-id":t.value.operationalBase.department.id},null,8,["modelValue","selected-department-id"])]),t.value?(l(),r(M,{key:0},[e("div",null,[ge,e("div",ye,[n(e("input",{id:"experience_title","onUpdate:modelValue":a[2]||(a[2]=o=>t.value.title=o),placeholder:"Eg. Glacier Wonders",type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.title]])])]),e("div",null,[he,e("div",ke,[n(e("textarea",{id:"experience_description","onUpdate:modelValue":a[3]||(a[3]=o=>t.value.description=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[b,t.value.description]])])]),e("div",we,[e("div",null,[Be,e("div",Ie,[n(e("input",{id:"bokun_id","onUpdate:modelValue":a[4]||(a[4]=o=>t.value.bokunId=o),placeholder:"Eg. 17340",type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.bokunId]])])]),e("div",null,[Ee,e("div",Ve,[n(e("input",{id:"bokun_product_code","onUpdate:modelValue":a[5]||(a[5]=o=>t.value.bokunProductCode=o),placeholder:"Eg. GG-GW",type:"text",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.bokunProductCode]])])]),e("div",null,[De,e("div",Ae,[n(e("select",{id:"customised_start_time","onUpdate:modelValue":a[6]||(a[6]=o=>t.value.customisedStartTime=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},Se,512),[[A,t.value.customisedStartTime]])])]),e("div",null,[Ue,e("div",Ce,[n(e("input",{id:"min_age","onUpdate:modelValue":a[7]||(a[7]=o=>t.value.minAge=o),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.minAge]])])]),e("div",null,[Le,e("div",Pe,[n(e("select",{id:"difficulty","onUpdate:modelValue":a[8]||(a[8]=o=>t.value.difficulty=o),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},[(l(!0),r(M,null,L(i(ne),o=>(l(),r("option",{key:o},P(o),1))),128))],512),[[A,t.value.difficulty]])])]),e("div",null,[qe,e("div",Te,[n(e("input",{id:"distance_hiked_in_meters","onUpdate:modelValue":a[9]||(a[9]=o=>t.value.distanceHikedInMeters=o),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.distanceHikedInMeters]])])]),e("div",null,[Ne,e("div",Fe,[n(e("input",{id:"distance_driven_in_meters","onUpdate:modelValue":a[10]||(a[10]=o=>t.value.distanceDrivenInMeters=o),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.distanceDrivenInMeters]])])]),e("div",null,[Re,e("div",$e,[n(e("select",{id:"experience_location_id","onUpdate:modelValue":a[11]||(a[11]=o=>t.value.experienceLocation=o),class:I(["block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",{"bg-gray-200 bg-none":i(u)().length===1}]),disabled:i(m)(i(V).getAllExperienceLocationsByOperationalBaseId)||i(u)().length===1,required:""},[(l(!0),r(M,null,L(i(u)(),o=>(l(),r("option",{key:o.id,value:o},P(o.name),9,Ge))),128))],10,je),[[A,t.value.experienceLocation]]),i(m)(i(V).getAllExperienceLocationsByOperationalBaseId)?(l(),r("div",He,[_(O,{class:"h-3 w-3 text-gray-500"})])):x("",!0)])]),e("div",null,[ze,e("div",We,[n(e("input",{id:"duration_in_minutes","onUpdate:modelValue":a[12]||(a[12]=o=>t.value.durationInMinutes=o),type:"number",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[b,t.value.durationInMinutes]])])]),e("div",null,[Je,e("div",Qe,[_(i(de),{modelValue:t.value.allowVehicles,"onUpdate:modelValue":a[13]||(a[13]=o=>t.value.allowVehicles=o),class:I(["relative inline-flex h-6 w-11 items-center rounded-full",t.value.allowVehicles?"bg-green-600":"bg-gray-200"])},{default:B(()=>[e("span",{class:I([t.value.allowVehicles?"translate-x-6":"translate-x-1","inline-block h-4 w-4 rounded-full bg-white transition"])},null,2)]),_:1},8,["modelValue","class"])])])])],64)):x("",!0)]),t.value?(l(),r("div",Xe,[e("div",Ye,[_(F,{name:"alert"},{default:B(()=>[i(v)(i(p).editExperience)?(l(),y(ae,{key:0,action:i(p).editExperience},null,8,["action"])):x("",!0)]),_:1}),_(F,{name:"alert"},{default:B(()=>[i(U)(i(p).editExperience)?(l(),y(le,{key:0,action:i(p).editExperience},null,8,["action"])):x("",!0)]),_:1}),e("div",Ke,[e("button",{class:"ml-3 inline-flex h-9 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700",onClick:K(z,["prevent"])},[i(m)(i(p).editExperience)?(l(),y(O,{key:1,class:"h-3 w-3 text-white"})):(l(),r("span",Ze," Save Experience "))])])])])):x("",!0)],512)):x("",!0)])]),_:1})}}});et.__docgenInfo={exportName:"default",displayName:"Edit",description:"",tags:{},props:[{name:"experienceId",required:!0,type:{name:"number"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/experiences/Edit.vue"]};export{et as default};
