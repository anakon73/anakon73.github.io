import{e as M,z as Q,g as k,j as x,o as n,k as u,u as t,A as y,B as m,C as b,D as c,E as W,x as A,G as N,l as X,F as Y,H as Z,b as S}from"./vue.esm-bundler-CYPfFjdk.js";import{o as ee,n as ae}from"./index-LmGWO5sK.js";import{u as te,a as se,_ as ne}from"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import{f as re}from"./index-TCXC35p5.js";import{i as oe}from"./query-G1AwWss6.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import{_ as le}from"./PAlert-quHLeqTA.js";import{_ as ue}from"./POverlay-3jPNvx4x.js";import{_ as ie}from"./PDialogTitle-rfxNVwSR.js";import{_ as de}from"./DepartureListItem-I88AIHqM.js";const me={key:0,class:"inline-block rounded-lg rounded-tl-none bg-teal-100 px-3 py-1 text-xs leading-none"},ce=["href","onClick","textContent"],pe=M({__name:"DepartureList",props:{date:{},departmentId:{},operationalBaseId:{},showClosedOrCancelled:{type:Boolean},compact:{type:Boolean},showFallback:{type:Boolean}},setup($){const F=$,{date:p,departmentId:L,operationalBaseId:_,showClosedOrCancelled:R}=Q(F),{isFetched:T,isLoading:g,isRefetching:q,data:C}=oe({date:p,operationalBaseId:_}),{data:O}=te(),{data:V}=se(),D=k(()=>{var e;return(e=C.value)==null?void 0:e.filter(a=>R.value||a.totalPassengerCount).map(a=>({...a,scheduledUsers:a.scheduledUsers.map(r=>{var l,v;const o=(l=O.value)==null?void 0:l.find(d=>d.id===r.userId),s=(v=V.value)==null?void 0:v.find(d=>d.id===r.vehicleId);return!o||r.vehicleId&&!s?null:{...ee(o,["id","name","avatar","phone"]),vehicleRegistrationNumber:(s==null?void 0:s.registrationNumber)??null,vehicleTitle:(s==null?void 0:s.title)??null,maxCapacity:(s==null?void 0:s.maxCapacity)??0,bookingSystemAvailability:a.bookingSystemAvailability}}).filter(ae)}))}),f=x(!1),i=x(null),h=k(()=>{var e;return(e=C.value)==null?void 0:e.find(a=>a.id===i.value)}),U=e=>{i.value=e,f.value=!0},j=()=>{i.value=null,f.value=!1},w=e=>{const[a,r]=e.split(":").map(Number);return a*60+r},B=k(()=>{var e;return(e=D.value)==null?void 0:e.slice().sort((a,r)=>{const o=w(a.departure.time),s=w(r.departure.time);return o-s})});return(e,a)=>{const r=W("RouterLink");return n(),u("div",null,[t(p)?(n(),y(t(ue),{key:0,show:t(g)||t(q),class:b(t(g)&&"min-h-80")},{default:m(()=>{var o,s;return[e.showFallback&&t(T)&&!t(g)&&!((o=B.value)!=null&&o.length)?(n(),y(t(le),{key:0,variant:"warn"},{heading:m(()=>[A(" No departures for this day ")]),default:m(()=>[A(" Have you created any experiences for this department? ")]),_:1})):(n(),u("div",{key:1,class:b(!e.compact&&"space-y-4")},[(s=D.value)!=null&&s.length?(n(),u("span",me,N(t(re)(t(p))),1)):c("",!0),X("div",{class:b(["flex flex-col",!e.compact&&"gap-4"])},[(n(!0),u(Y,null,Z(B.value,({id:l,comment:v,status:d,totalPassengerCount:z,tour:{name:I,thumbnailUrl:E},departure:{time:H},scheduledUsers:P,bookingSystemAvailability:G})=>(n(),u("div",{key:l},[S(r,{to:{name:e.$Routes.DepartureShow,params:{departureId:l}},custom:""},{default:m(({href:J,navigate:K})=>[e.compact?c("",!0):(n(),u("a",{key:0,class:"mb-1 text-gray-500",href:J,onClick:K,textContent:N(I)},null,8,ce)),S(t(de),{"scheduled-departure-id":l,"booking-system-availability":G,"tour-name":I,"tour-thumbnail-url":E,time:H,"total-passenger-count":z,comment:v,status:d,"scheduled-users":P,compact:e.compact,onStartAssignment:fe=>U(l)},null,8,["scheduled-departure-id","booking-system-availability","tour-name","tour-thumbnail-url","time","total-passenger-count","comment","status","scheduled-users","compact","onStartAssignment"])]),_:2},1032,["to"])]))),128))],2)],2))]}),_:1},8,["show","class"])):c("",!0),t(p)&&t(L)&&t(_)?(n(),y(t(ie),{key:1,open:f.value,onClose:a[0]||(a[0]=o=>f.value=!1),onClosed:a[1]||(a[1]=o=>i.value=null)},{default:m(()=>[h.value?(n(),y(t(ne),{key:0,class:"md:w-[43rem]","scheduled-departure-id":i.value,"tour-time":h.value.departure.time,"tour-name":h.value.tour.name,"scheduled-users":h.value.scheduledUsers,onClose:j},null,8,["scheduled-departure-id","tour-time","tour-name","scheduled-users"])):c("",!0)]),_:1},8,["open"])):c("",!0)])}}});pe.__docgenInfo={exportName:"default",displayName:"DepartureList",description:"",tags:{},props:[{name:"date",required:!1,type:{name:"union",elements:[{name:"Date"},{name:"null"}]}},{name:"departmentId",required:!1,type:{name:"union",elements:[{name:"TSIndexedAccessType"},{name:"null"}]}},{name:"operationalBaseId",required:!1,type:{name:"union",elements:[{name:"TSIndexedAccessType"},{name:"null"}]}},{name:"showClosedOrCancelled",required:!1,type:{name:"boolean"}},{name:"compact",required:!1,type:{name:"boolean"}},{name:"showFallback",required:!1,type:{name:"boolean"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/widgets/departure-list/DepartureList.vue"]};export{pe as _};
