import{e as G,z as L,j as f,q as J,w as H,o as l,A as c,B as h,E as K,l as e,u as a,b as v,J as p,P as u,D as V,T as k,N as Q,k as W,a0 as X,a1 as Y}from"./vue.esm-bundler-CYPfFjdk.js";import{s as U}from"./schemas-74JEr9Jm.js";import{R as Z}from"./RightDrawer-Lpr6admO.js";import{a as ee,f as te}from"./preview-D0Pi-YKn.js";import{P as I}from"./ProgressSpinner-lCLkagxy.js";import{I as oe}from"./IconClose-tbzieUCA.js";import{_ as ie,a as se}from"./ActionErrorAlert--bGVRXV4.js";import{a as ae,b as C}from"./useVehicle-nrY-7Tml.js";import{u as re}from"./useOrganisation-sTqlSIPt.js";import{O as ne}from"./ApiGetRequestDTO-QMLlugHb.js";import{_ as me}from"./VDepartmentMultiSelect-o-LqVwHz.js";import{_ as le}from"./_plugin-vue_export-helper-x3n3nnut.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./IconTickMarkCircle-2_sKm8Jk.js";import"./useDepartment-RZahlhen.js";import"./useOperationalBase-kvvO22e1.js";var N=(r=>(r.NAME="name",r))(N||{});const n=r=>(X("data-v-d87d6c62"),r=r(),Y(),r),de={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},ce={class:"sticky top-0 z-10 flex w-full items-center justify-end bg-white p-6"},pe={class:"space-y-8 divide-y divide-gray-200"},ue=n(()=>e("div",null,[e("div",null,[e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," Edit Vehicle "),e("p",{class:"mt-1 text-sm text-gray-500"}," Use the form below to update the details for the vehicle. ")])],-1)),fe={class:"pt-8"},he=n(()=>e("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," Vehicle Details ",-1)),ve={class:"mt-6 grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-6"},_e={class:"sm:col-span-6"},be={class:"sm:col-span-3"},ye=n(()=>e("label",{for:"registration_number",class:"block text-sm font-medium text-gray-700"}," Registration Number ",-1)),ge={class:"sm:col-span-3"},xe=n(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Name ",-1)),we={class:"sm:col-span-3"},Ve=n(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Max capacity ",-1)),ke={class:"sm:col-span-3"},Ue=n(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," Comfort capacity ",-1)),Ie=["max"],Ce={class:"sm:col-span-3"},Ne=n(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," In use from ",-1)),Ee={class:"sm:col-span-3"},De=n(()=>e("label",{for:"name",class:"block text-sm font-medium text-gray-700"}," In use until ",-1)),Fe={class:"relative pt-5"},Se={class:"flex items-center justify-end"},Oe={class:"flex items-center"},Be={key:0},E=G({__name:"Edit",props:{vehicleId:{}},setup(r){const D=r,{vehicleId:b}=L(D),{validateForm:F,actionIsInProgress:_,actionIsInSuccess:S,actionIsInError:O}=ee(),{vehicleActions:d,storeUpdateVehicleInIndex:B,apiGetVehicle:R,apiUpdateVehicle:T}=ae(),{organisationActions:A,apiGetOrganisations:q}=re(),{storeFilterState:y}=U(te()),{storeRemoveVehicleFromIndex:M,storeAddVehicleToIndex:j}=C(),{storeVehicles:$}=U(C()),g=f(null),P=f([]),x=f({id:b.value}),s=f({id:0,organisationId:1,departments:[],name:"",registrationNumber:"",maxCapacity:12,comfortCapacity:12,inUseFrom:null,inUseUntil:null}),z=async()=>{if(s.value){const i=await T(s.value);if(i){const t=i.data.vehicle;B(t),t.departments.some(m=>{var o;return m.id===((o=y.value.selectedDepartment)==null?void 0:o.id)})||M(t),t.departments.some(m=>{var o;return m.id===((o=y.value.selectedDepartment)==null?void 0:o.id)})&&($.value.find(m=>m.id===t.id)||j(t))}}},w=async()=>{const i=await R(x.value);s.value={id:i.data.vehicle.id,organisationId:i.data.vehicle.organisationId,departments:i.data.vehicle.departments,name:i.data.vehicle.name,registrationNumber:i.data.vehicle.registrationNumber,maxCapacity:i.data.vehicle.maxCapacity,comfortCapacity:i.data.vehicle.comfortCapacity,inUseFrom:i.data.vehicle.inUseFrom,inUseUntil:i.data.vehicle.inUseUntil}};return J(async()=>{const i={sortBy:N.NAME,orderBy:ne.DESC};await w();const t=await q(i);P.value=t.data.organisations}),H(b,async i=>{i&&(x.value.id=Number.parseInt(i.toString()),await w())}),(i,t)=>{const m=K("RouterLink");return l(),c(Z,null,{default:h(()=>[e("div",de,[e("div",ce,[a(_)(a(d).getVehicleById)||a(_)(a(A).getAllOrganisations)?(l(),c(I,{key:0,class:"h-5 w-5 text-blue-500"})):(l(),c(m,{key:1,to:{name:i.$Routes.Vehicles}},{default:h(()=>[v(oe,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"]))]),e("form",{id:"edit_vehicle_form",ref_key:"editVehicleFormElement",ref:g,class:"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12"},[e("div",pe,[ue,e("div",fe,[he,e("div",ve,[e("div",_e,[v(me,{"selected-departments":s.value.departments,"onUpdate:selectedDepartments":t[0]||(t[0]=o=>s.value.departments=o)},null,8,["selected-departments"])]),e("div",be,[ye,p(e("input",{id:"registration_number","onUpdate:modelValue":t[1]||(t[1]=o=>s.value.registrationNumber=o),type:"text",name:"registration_number",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[u,s.value.registrationNumber]])]),e("div",ge,[xe,p(e("input",{id:"name","onUpdate:modelValue":t[2]||(t[2]=o=>s.value.name=o),type:"text",name:"name",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[u,s.value.name]])]),e("div",we,[Ve,p(e("input",{id:"max_capacity","onUpdate:modelValue":t[3]||(t[3]=o=>s.value.maxCapacity=o),type:"number",name:"max_capacity",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,512),[[u,s.value.maxCapacity]])]),e("div",ke,[Ue,p(e("input",{id:"comfort_capacity","onUpdate:modelValue":t[4]||(t[4]=o=>s.value.comfortCapacity=o),max:s.value.maxCapacity,type:"number",name:"comfort_capacity",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:""},null,8,Ie),[[u,s.value.comfortCapacity]])]),e("div",Ce,[Ne,p(e("input",{id:"in_use_from","onUpdate:modelValue":t[5]||(t[5]=o=>s.value.inUseFrom=o),type:"date",name:"in_use_from",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[u,s.value.inUseFrom]])]),e("div",Ee,[De,p(e("input",{id:"in_use_until","onUpdate:modelValue":t[6]||(t[6]=o=>s.value.inUseUntil=o),type:"date",name:"in_use_until",class:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"},null,512),[[u,s.value.inUseUntil]])])])])]),e("div",Fe,[e("div",Se,[v(k,{name:"alert"},{default:h(()=>[a(S)(a(d).editVehicle)?(l(),c(ie,{key:0,action:a(d).editVehicle},null,8,["action"])):V("",!0)]),_:1}),v(k,{name:"alert"},{default:h(()=>[a(O)(a(d).editVehicle)?(l(),c(se,{key:0,action:a(d).editVehicle},null,8,["action"])):V("",!0)]),_:1}),e("div",Oe,[e("button",{class:"ml-3 inline-flex h-9 w-32 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700",onClick:t[7]||(t[7]=Q(o=>a(F)(g.value,()=>z()),["prevent"]))},[a(_)(a(d).editVehicle)?(l(),c(I,{key:1,class:"h-3 w-3 text-white"})):(l(),W("span",Be," Save Changes "))])])])])],512)])]),_:1})}}}),po=le(E,[["__scopeId","data-v-d87d6c62"]]);E.__docgenInfo={exportName:"default",displayName:"Edit",description:"",tags:{},props:[{name:"vehicleId",required:!0,type:{name:"number"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/vehicles/Edit.vue"]};export{po as default};
