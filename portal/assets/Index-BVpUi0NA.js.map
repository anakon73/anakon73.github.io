{"version":3,"file":"Index-BVpUi0NA.js","sources":["../../src/shared/types/vehicles/IVehicle.ts","../../src/pages/vehicles/Index.vue"],"sourcesContent":["import type { IDepartment } from '@/shared/types/departments/IDepartments'\n\nexport interface IVehicle {\n  id: number\n  organisationId: number\n  departments: IDepartment[]\n  name: string | null\n  registrationNumber: string\n  maxCapacity: number\n  comfortCapacity: number\n  inUseFrom: string\n  inUseUntil: string\n  createdAt: Date\n  updatedAt: Date\n}\n\nexport enum VehicleSortableFields {\n  NAME = 'name',\n}\n","<script setup lang=\"ts\">\nimport { onUnmounted } from 'vue'\nimport { storeToRefs } from 'pinia'\nimport MainContent from '@/shared/ui/layout/MainContent.vue'\nimport ProgressSpinner from '@/shared/ui/ProgressSpinner.vue'\nimport { useUi } from '@/shared/lib/composables/useUi'\nimport { useVehicle } from '@/shared/api/useVehicle'\nimport type { GetVehiclesDTO } from '@/shared/types/vehicles/vehicleDTOs'\nimport { VehicleSortableFields } from '@/shared/types/vehicles/IVehicle'\nimport { OrderBy } from '@/shared/types/requests/ApiGetRequestDTO'\nimport { useVehicleStore } from '@/shared/api/stores/vehicle'\nimport VVehicleRegistrationPlate from '@/shared/ui/VVehicleRegistrationPlate.vue'\nimport VDataFilters from '@/shared/ui/inputs/VDataFilters.vue'\nimport { useUiStore } from '@/shared/lib/composables/ui'\nimport type { IDataFilters } from '@/shared/types/inputs/IDataFilters'\nimport { AppPermissions } from '@/shared/types/enums/permissions/permissions'\nimport { useAuth } from '@/shared/api/useAuth'\n\nconst {\n  vehicleActions,\n  apiGetVehicles,\n  storeClearAllVehicles,\n  storeSetVehicles,\n} = useVehicle()\nconst { storeVehicles } = storeToRefs(useVehicleStore())\nconst { actionIsInProgress } = useUi()\n\nconst { storeSetFilterState } = useUiStore()\nconst { storeFilterState } = storeToRefs(useUiStore())\nconst { userHasPermissionInDepartment } = useAuth()\n\nconst handleFilterStateUpdate = async (newFilterState: IDataFilters) => {\n  storeSetFilterState(newFilterState)\n\n  const getVehiclesDTO: GetVehiclesDTO = {\n    selectedDepartment: storeFilterState.value.selectedDepartment,\n    sortBy: VehicleSortableFields.NAME,\n    orderBy: OrderBy.ASC,\n  }\n\n  const rsp = await apiGetVehicles(getVehiclesDTO)\n\n  if (rsp) {\n    const vehicles = rsp.data.vehicles\n    storeSetVehicles(vehicles)\n  }\n}\n\nonUnmounted(() => {\n  storeClearAllVehicles()\n})\n</script>\n\n<template>\n  <MainContent main-content-title=\"Manage Vehicles\">\n    <div\n      v-if=\"storeFilterState.selectedDepartment && userHasPermissionInDepartment(\n        AppPermissions.MANAGE_VEHICLES,\n        storeFilterState.selectedDepartment,\n      )\"\n      class=\"flex w-full justify-end py-6\"\n    >\n      <RouterLink\n        :to=\"{ name: $Routes.VehicleCreate }\"\n        class=\"block w-full whitespace-nowrap rounded-md bg-blue-600 px-3 py-1.5 text-center text-sm font-semibold leading-6 text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 hover:bg-blue-500 md:w-48\"\n      >\n        Add Vehicle\n      </RouterLink>\n    </div>\n\n    <VDataFilters\n      :department-permissions-required=\"[\n        AppPermissions.VIEW_VEHICLES,\n      ]\"\n      filter-by-departments\n      :filter-state=\"storeFilterState\"\n      allow-no-department\n      @filter-state-updated=\"handleFilterStateUpdate\"\n    />\n\n    <div class=\"flex flex-col pb-4\">\n      <div class=\"flow-root md:mt-8\">\n        <div class=\"overflow-x-auto\">\n          <div class=\"inline-block min-w-full py-2 align-middle\">\n            <div\n              v-if=\"actionIsInProgress(vehicleActions.getAllVehicles)\"\n              class=\"flex h-[50px] items-center justify-center rounded border border-gray-100 bg-gray-50 shadow\"\n            >\n              <ProgressSpinner class=\"h-5 w-5 text-blue-600\" />\n            </div>\n\n            <table\n              v-else\n              class=\"min-w-full divide-y divide-gray-300 rounded border border-gray-100 bg-white shadow\"\n            >\n              <thead>\n                <tr>\n                  <th scope=\"col\" class=\"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                    Registration\n                  </th>\n                  <th scope=\"col\" class=\"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                    Name\n                  </th>\n                  <th v-if=\"storeFilterState.selectedDepartment === null\" scope=\"col\" class=\"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                    Department\n                  </th>\n                </tr>\n              </thead>\n              <tbody class=\"divide-y divide-gray-200\">\n                <template v-if=\"storeVehicles.length === 0\">\n                  <tr>\n                    <td colspan=\"8\" class=\"px-3 py-3.5 text-center text-sm text-gray-500\">\n                      No vehicles found for this department.\n                    </td>\n                  </tr>\n                </template>\n                <template v-else>\n                  <tr\n                    v-for=\"vehicle in storeVehicles\"\n                    :key=\"vehicle.id\"\n                  >\n                    <td class=\"flex items-center whitespace-nowrap p-3 text-sm font-medium text-gray-900\">\n                      <VVehicleRegistrationPlate :registration=\"vehicle.registrationNumber\" />\n                    </td>\n                    <td class=\"whitespace-nowrap p-3 text-sm text-gray-500\">\n                      <span v-if=\"vehicle.name\">\n                        \"{{ vehicle.name }}\"\n                      </span>\n                      <span v-else>\n                        -\n                      </span>\n                    </td>\n                    <td v-if=\"storeFilterState.selectedDepartment === null\" class=\"whitespace-nowrap p-3 text-sm text-gray-500\">\n                      <div\n                        v-if=\"vehicle.departments.length\"\n                      >\n                        <div\n                          v-for=\"department in vehicle.departments\"\n                          :key=\"department.id\"\n                          class=\"p-2\"\n                        >\n                          {{ department.name }}\n                        </div>\n                      </div>\n                      <span v-else class=\"p-2 text-red-500\">None</span>\n                    </td>\n                    <td class=\"relative whitespace-nowrap p-3 text-right text-sm font-medium\">\n                      <RouterLink\n                        :to=\"{ name: $Routes.VehicleEdit, params: { vehicleId: vehicle.id } }\"\n                        class=\"text-blue-600 hover:text-blue-900\"\n                      >\n                        View\n                      </RouterLink>\n                    </td>\n                  </tr>\n                </template>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </MainContent>\n</template>\n"],"names":["VehicleSortableFields","vehicleActions","apiGetVehicles","storeClearAllVehicles","storeSetVehicles","useVehicle","storeVehicles","storeToRefs","useVehicleStore","actionIsInProgress","useUi","storeSetFilterState","useUiStore","storeFilterState","userHasPermissionInDepartment","useAuth","handleFilterStateUpdate","newFilterState","getVehiclesDTO","OrderBy","rsp","vehicles","onUnmounted"],"mappings":"2wHAgBY,IAAAA,GAAAA,IACVA,EAAA,KAAO,OADGA,IAAAA,GAAA,CAAA,CAAA,8xCCEN,KAAA,CACJ,eAAAC,EACA,eAAAC,EACA,sBAAAC,EACA,iBAAAC,GACEC,EAAW,EACT,CAAE,cAAAC,CAAkB,EAAAC,EAAYC,EAAiB,CAAA,EACjD,CAAE,mBAAAC,GAAuBC,IAEzB,CAAE,oBAAAC,GAAwBC,IAC1B,CAAE,iBAAAC,CAAqB,EAAAN,EAAYK,EAAY,CAAA,EAC/C,CAAE,8BAAAE,GAAkCC,IAEpCC,EAA0B,MAAOC,GAAiC,CACtEN,EAAoBM,CAAc,EAElC,MAAMC,EAAiC,CACrC,mBAAoBL,EAAiB,MAAM,mBAC3C,OAAQb,EAAsB,KAC9B,QAASmB,EAAQ,GAAA,EAGbC,EAAM,MAAMlB,EAAegB,CAAc,EAE/C,GAAIE,EAAK,CACD,MAAAC,EAAWD,EAAI,KAAK,SAC1BhB,EAAiBiB,CAAQ,CAC3B,CAAA,EAGF,OAAAC,EAAY,IAAM,CACMnB,GAAA,CACvB"}