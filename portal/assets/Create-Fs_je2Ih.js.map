{"version":3,"file":"Create-Fs_je2Ih.js","sources":["../../src/pages/vehicles/Create.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport RightDrawer from '@/shared/ui/layout/RightDrawer.vue'\nimport { useUi } from '@/shared/lib/composables/useUi'\nimport IconClose from '@/shared/ui/icons/IconClose.vue'\nimport ProgressSpinner from '@/shared/ui/ProgressSpinner.vue'\nimport ActionErrorAlert from '@/shared/ui/forms/ActionErrorAlert.vue'\nimport ActionSuccessAlert from '@/shared/ui/forms/ActionSuccessAlert.vue'\nimport type { CreateVehicleDTO } from '@/shared/types/vehicles/vehicleDTOs'\nimport { useVehicle } from '@/shared/api/useVehicle'\nimport { useOrganisation } from '@/shared/api/useOrganisation'\nimport VDepartmentMultiSelect from '@/shared/ui/inputs/VDepartmentMultiSelect.vue'\n\nconst { validateForm, actionIsInProgress, actionIsInError, actionIsInSuccess } = useUi()\n\nconst {\n  vehicleActions,\n  apiCreateVehicle,\n  storeAddVehicleToIndex,\n} = useVehicle()\nconst { organisationActions } = useOrganisation()\n\nconst createVehicleFormElement = ref<HTMLFormElement | null>(null)\n\nconst createVehicleDTO = ref<CreateVehicleDTO>({\n  organisationId: 1,\n  departments: [],\n  name: '',\n  registrationNumber: '',\n  maxCapacity: 12,\n  comfortCapacity: 12,\n  inUseFrom: null,\n  inUseUntil: null,\n})\n\nconst handleCreateVehicle = async () => {\n  const rsp = await apiCreateVehicle(createVehicleDTO.value)\n  if (rsp.status === 201) {\n    storeAddVehicleToIndex(rsp.data.vehicle)\n  }\n}\n</script>\n\n<template>\n  <RightDrawer>\n    <div class=\"isolate flex flex-col items-center justify-center border-l bg-white pb-6\">\n      <div class=\"sticky top-0 z-10 flex w-full items-center justify-end bg-white p-6\">\n        <ProgressSpinner\n          v-if=\"actionIsInProgress(organisationActions.getAllOrganisations)\"\n          class=\"h-5 w-5 text-blue-500\"\n        />\n        <RouterLink\n          v-else\n          :to=\"{ name: $Routes.Vehicles }\"\n        >\n          <IconClose class=\"h-5 w-5 fill-red-400\" />\n        </RouterLink>\n      </div>\n      <form\n        id=\"create_user_form\"\n        ref=\"createVehicleFormElement\"\n        class=\"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12\"\n      >\n        <div class=\"space-y-8 divide-y divide-gray-200\">\n          <div>\n            <div>\n              <h3 class=\"text-base font-semibold leading-6 text-gray-900\">\n                Add a new vehicle.\n              </h3>\n              <p class=\"mt-1 text-sm text-gray-500\">\n                Complete the form below to add a new vehicle to the Portal.\n              </p>\n            </div>\n          </div>\n\n          <div class=\"pt-8\">\n            <h3 class=\"text-base font-semibold leading-6 text-gray-900\">\n              Vehicle Details\n            </h3>\n            <div class=\"mt-6 grid grid-cols-1 gap-x-4 gap-y-6 sm:grid-cols-6\">\n              <div class=\"sm:col-span-6\">\n                <VDepartmentMultiSelect v-model:selected-departments=\"createVehicleDTO.departments\" />\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"registration_number\" class=\"block text-sm font-medium text-gray-700\">\n                  Registration Number\n                </label>\n                <input\n                  id=\"registration_number\"\n                  v-model=\"createVehicleDTO.registrationNumber\"\n                  type=\"text\"\n                  name=\"registration_number\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                  required\n                >\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">\n                  Name\n                </label>\n                <input\n                  id=\"name\"\n                  v-model=\"createVehicleDTO.name\"\n                  type=\"text\"\n                  name=\"name\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                  required\n                >\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">\n                  Max capacity\n                </label>\n                <input\n                  id=\"max_capacity\"\n                  v-model=\"createVehicleDTO.maxCapacity\"\n                  type=\"number\"\n                  name=\"max_capacity\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                  required\n                >\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">\n                  Comfort capacity\n                </label>\n                <input\n                  id=\"comfort_capacity\"\n                  v-model=\"createVehicleDTO.comfortCapacity\"\n                  :max=\"createVehicleDTO.maxCapacity\"\n                  type=\"number\"\n                  name=\"comfort_capacity\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                  required\n                >\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">\n                  In use from\n                </label>\n                <input\n                  id=\"in_use_from\"\n                  v-model=\"createVehicleDTO.inUseFrom\"\n                  type=\"date\"\n                  name=\"in_use_from\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                >\n              </div>\n\n              <div class=\"sm:col-span-3\">\n                <label for=\"name\" class=\"block text-sm font-medium text-gray-700\">\n                  In use until\n                </label>\n                <input\n                  id=\"in_use_until\"\n                  v-model=\"createVehicleDTO.inUseUntil\"\n                  type=\"date\"\n                  name=\"in_use_until\"\n                  class=\"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm\"\n                >\n              </div>\n            </div>\n          </div>\n        </div>\n\n        <div class=\"relative pt-5\">\n          <div class=\"flex items-center justify-end\">\n            <Transition name=\"alert\">\n              <ActionSuccessAlert\n                v-if=\"actionIsInSuccess(vehicleActions.createVehicle)\"\n                :action=\"vehicleActions.createVehicle\"\n              />\n            </Transition>\n            <Transition name=\"alert\">\n              <ActionErrorAlert\n                v-if=\"actionIsInError(vehicleActions.createVehicle)\"\n                :action=\"vehicleActions.createVehicle\"\n              />\n            </Transition>\n            <div class=\"flex items-center\">\n              <button\n                class=\"ml-3 inline-flex h-9 items-center justify-center rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm font-medium text-white shadow-sm focus:outline-none hover:bg-blue-700\"\n                @click.prevent=\"validateForm(createVehicleFormElement, () => handleCreateVehicle())\"\n              >\n                <span v-if=\"!actionIsInProgress(vehicleActions.createVehicle)\">\n                  Save\n                </span>\n                <ProgressSpinner\n                  v-else\n                  class=\"h-3 w-3 text-white\"\n                />\n              </button>\n            </div>\n          </div>\n        </div>\n      </form>\n    </div>\n  </RightDrawer>\n</template>\n\n<style scoped>\n.alert-enter-active,\n.alert-leave-active {\n  transition: all 0.5s cubic-bezier(0, 1.3, 1, 1.05);\n}\n\n.alert-enter-from {\n  opacity: 0;\n  transform: translateX(-300px);\n}\n.alert-leave-to {\n  opacity: 0;\n}\n</style>\n"],"names":["validateForm","actionIsInProgress","actionIsInError","actionIsInSuccess","useUi","vehicleActions","apiCreateVehicle","storeAddVehicleToIndex","useVehicle","organisationActions","useOrganisation","createVehicleFormElement","ref","createVehicleDTO","handleCreateVehicle","rsp"],"mappings":"ilJAaA,KAAM,CAAE,aAAAA,EAAc,mBAAAC,EAAoB,gBAAAC,EAAiB,kBAAAC,CAAA,EAAsBC,IAE3E,CACJ,eAAAC,EACA,iBAAAC,EACA,uBAAAC,GACEC,EAAW,EACT,CAAE,oBAAAC,GAAwBC,IAE1BC,EAA2BC,EAA4B,IAAI,EAE3DC,EAAmBD,EAAsB,CAC7C,eAAgB,EAChB,YAAa,CAAC,EACd,KAAM,GACN,mBAAoB,GACpB,YAAa,GACb,gBAAiB,GACjB,UAAW,KACX,WAAY,IAAA,CACb,EAEKE,EAAsB,SAAY,CACtC,MAAMC,EAAM,MAAMT,EAAiBO,EAAiB,KAAK,EACrDE,EAAI,SAAW,KACMR,EAAAQ,EAAI,KAAK,OAAO,CACzC"}