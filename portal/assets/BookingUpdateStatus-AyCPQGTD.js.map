{"version":3,"file":"BookingUpdateStatus-AyCPQGTD.js","sources":["../../node_modules/.pnpm/@heroicons+vue@2.1.1_vue@3.4.7/node_modules/@heroicons/vue/20/solid/esm/PlusCircleIcon.js","../../src/features/booking/update-booking-status/BookingUpdateStatus.vue"],"sourcesContent":["import { createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport default function render(_ctx, _cache) {\n  return (_openBlock(), _createElementBlock(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 20 20\",\n    fill: \"currentColor\",\n    \"aria-hidden\": \"true\",\n    \"data-slot\": \"icon\"\n  }, [\n    _createElementVNode(\"path\", {\n      \"fill-rule\": \"evenodd\",\n      d: \"M10 18a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm.75-11.25a.75.75 0 0 0-1.5 0v2.5h-2.5a.75.75 0 0 0 0 1.5h2.5v2.5a.75.75 0 0 0 1.5 0v-2.5h2.5a.75.75 0 0 0 0-1.5h-2.5v-2.5Z\",\n      \"clip-rule\": \"evenodd\"\n    })\n  ]))\n}","<script setup lang=\"ts\">\nimport { toRefs } from 'vue'\nimport { push } from 'notivue'\nimport { Listbox, ListboxButton, ListboxOption, ListboxOptions } from '@headlessui/vue'\nimport { Float } from '@headlessui-float/vue'\nimport { CheckCircleIcon, ChevronDownIcon, PlusCircleIcon } from '@heroicons/vue/20/solid'\n\nimport { BookingStatus as Status, type TourBooking } from '@/shared/types'\nimport { includes } from '@/shared/lib/utils'\n\nimport { type ClassValue, cn } from '@/shared/lib/style'\nimport { POverlay } from '@/shared/ui/POverlay'\nimport { useTourBookingUpdate } from '@/shared/api/booking'\n\nexport interface Props {\n  tourBookingId: TourBooking['id']\n  status: Status\n  totalCount: number\n  arrivedCount: number | null\n  hideLabel?: boolean\n}\n\nconst props = defineProps<Props>()\nconst { arrivedCount, tourBookingId, totalCount, status } = toRefs(props)\n\nconst menuItems: { label: string; value: Status; color: ClassValue }[] = [\n  { label: 'Confirmed', value: Status.Confirmed, color: cn('bg-gray-500') },\n  { label: 'Arrived', value: Status.Arrived, color: cn('bg-green-500') },\n  { label: 'No Show', value: Status.Cancelled, color: cn('bg-red-500') },\n]\n\nconst { mutate, isPending } = useTourBookingUpdate()\n\nconst saveStatus = (value: Status) => {\n  mutate({\n    tourBookingId: tourBookingId.value,\n    status: value,\n  }, {\n    onSuccess() {\n      push.success({ message: 'Booking status updated' })\n    },\n  })\n}\n\nconst toggleStatus = () => {\n  if (status.value === Status.Cancelled) return\n\n  saveStatus(\n    status.value === Status.Confirmed\n      ? Status.Arrived\n      : Status.Confirmed,\n  )\n}\n</script>\n\n<template>\n  <Listbox v-slot=\"{ open }\" @update:model-value=\"saveStatus($event)\">\n    <Float\n      as=\"div\"\n      class=\"relative\"\n      :class=\"!hideLabel ? 'min-w-48' : 'min-w-36'\"\n      placement=\"bottom\"\n      floating-as=\"template\"\n      enter=\"transition duration-200 ease-out\"\n      enter-from=\"scale-90 opacity-0\"\n      enter-to=\"scale-100 opacity-100\"\n      leave=\"transition duration-150 ease-in\"\n      leave-from=\"scale-100 opacity-100\"\n      leave-to=\"scale-90 opacity-0\"\n      tailwindcss-origin-class\n      flip\n    >\n      <POverlay :show=\"isPending\">\n        <ListboxButton\n          class=\"\n        flex w-full select-none items-stretch rounded-md border\n        border-gray-200 shadow-md transition-shadow hover:shadow-lg\n        \"\n        >\n          <div\n            class=\"\n          group flex grow items-center justify-center gap-2 px-4 py-2.5\n          transition-colors\n          \"\n            :class=\"[\n              status !== Status.Cancelled && 'hover:bg-gray-100',\n              status === Status.Cancelled && 'cursor-not-allowed',\n            ]\"\n            @click.stop=\"toggleStatus\"\n          >\n            <CheckCircleIcon\n              v-if=\"status === Status.Arrived\"\n              class=\"h-6 w-6 group-hover:animate-pulse\"\n              :class=\"\n                arrivedCount !== totalCount\n                  ? 'text-green-300'\n                  : 'text-green-500'\n              \"\n            />\n\n            <PlusCircleIcon\n              v-if=\"status === Status.Cancelled\"\n              class=\"h-6 w-6 rotate-45 text-red-500\"\n            />\n\n            <span\n              v-if=\"status === Status.Confirmed\"\n              class=\"\n            h-5 w-5 rounded-full border-2 border-dashed border-gray-500\n            transition-transform group-hover:animate-spin\n            \"\n            />\n\n            <template v-if=\"!hideLabel\">\n              {{\n                includes([Status.Confirmed, Status.Arrived], status)\n                  ? 'Arrived'\n                  : 'No show'\n              }}\n            </template>\n          </div>\n\n          <div\n            class=\"\n          flex items-center justify-center justify-items-center gap-1 border-l\n          px-4 transition-colors hover:bg-gray-100\n          \"\n          >\n            <ChevronDownIcon\n              class=\"size-6 transition-transform\"\n              :class=\"[open && '-scale-100']\"\n            />\n          </div>\n        </ListboxButton>\n      </POverlay>\n\n      <ListboxOptions\n        as=\"ul\"\n        class=\"\n        flex w-full flex-col justify-between rounded-md border border-gray-200\n        shadow-md\n        \"\n      >\n        <ListboxOption\n          v-for=\"{ label, value, color } in menuItems\"\n          :key=\"value\"\n          v-slot=\"{ active, disabled }\"\n          :value=\"value\"\n          as=\"li\"\n          class=\"cursor-default\"\n          :disabled=\"value === status\"\n        >\n          <button\n            class=\"flex w-full items-center gap-2 px-5 py-2 transition-colors\"\n            :class=\"[\n              active || status === value ? 'bg-gray-200' : 'bg-white',\n              disabled && 'pointer-events-none cursor-default',\n            ]\"\n          >\n            <div class=\"h-1.5 w-1.5 rounded-full \" :class=\"color\" />\n\n            <p>{{ label }}</p>\n          </button>\n        </ListboxOption>\n      </ListboxOptions>\n    </Float>\n  </Listbox>\n</template>\n"],"names":["render","_ctx","_cache","_openBlock","_createElementBlock","_createElementVNode","props","__props","arrivedCount","tourBookingId","totalCount","status","toRefs","menuItems","Status","cn","mutate","isPending","useTourBookingUpdate","saveStatus","value","push","toggleStatus"],"mappings":"8nBAEe,SAASA,EAAOC,EAAMC,EAAQ,CAC3C,OAAQC,EAAU,EAAIC,EAAoB,MAAO,CAC/C,MAAO,6BACP,QAAS,YACT,KAAM,eACN,cAAe,OACf,YAAa,MACjB,EAAK,CACDC,EAAoB,OAAQ,CAC1B,YAAa,UACb,EAAG,mKACH,YAAa,SACnB,CAAK,CACL,CAAG,CACH,kYCMA,MAAMC,EAAQC,EACR,CAAE,aAAAC,EAAc,cAAAC,EAAe,WAAAC,EAAY,OAAAC,GAAWC,EAAON,CAAK,EAElEO,EAAmE,CACvE,CAAE,MAAO,YAAa,MAAOC,EAAO,UAAW,MAAOC,EAAG,aAAa,CAAE,EACxE,CAAE,MAAO,UAAW,MAAOD,EAAO,QAAS,MAAOC,EAAG,cAAc,CAAE,EACrE,CAAE,MAAO,UAAW,MAAOD,EAAO,UAAW,MAAOC,EAAG,YAAY,CAAE,CAAA,EAGjE,CAAE,OAAAC,EAAQ,UAAAC,CAAU,EAAIC,EAAqB,EAE7CC,EAAcC,GAAkB,CAC7BJ,EAAA,CACL,cAAeP,EAAc,MAC7B,OAAQW,CAAA,EACP,CACD,WAAY,CACVC,EAAK,QAAQ,CAAE,QAAS,wBAA0B,CAAA,CACpD,CAAA,CACD,CAAA,EAGGC,EAAe,IAAM,CACrBX,EAAO,QAAUG,EAAO,WAE5BK,EACER,EAAO,QAAUG,EAAO,UACpBA,EAAO,QACPA,EAAO,SAAA,CACb","x_google_ignoreList":[0]}