{"version":3,"file":"Index-m7T8ixAH.js","sources":["../../src/pages/training/Index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { onUnmounted } from 'vue'\nimport { storeToRefs } from 'pinia'\nimport MainContent from '@/shared/ui/layout/MainContent.vue'\nimport { useUi } from '@/shared/lib/composables/useUi'\nimport ProgressSpinner from '@/shared/ui/ProgressSpinner.vue'\nimport { useTraining } from '@/shared/api/useTraining'\nimport VDataFilters from '@/shared/ui/inputs/VDataFilters.vue'\nimport type { IDataFilters } from '@/shared/types/inputs/IDataFilters'\nimport { useUiStore } from '@/shared/lib/composables/ui'\nimport { useTrainingStore } from '@/shared/api/stores/training'\nimport { AppPermissions } from '@/shared/types/enums/permissions/permissions'\nimport { useAuth } from '@/shared/api/useAuth'\n\nconst { trainingActions } = useTraining()\nconst { actionIsInProgress } = useUi()\n\nconst { storeFilterState } = storeToRefs(useUiStore())\nconst { storeSetFilterState } = useUiStore()\nconst { apiGetTrainingByDepartmentId } = useTraining()\nconst { storeSetTraining, storeClearTraining } = useTrainingStore()\nconst { storeTraining } = storeToRefs(useTrainingStore())\n\nconst { userHasPermissionInDepartment } = useAuth()\n\nconst handleFilterStateUpdate = async (newFilterState: IDataFilters) => {\n  storeSetFilterState(newFilterState)\n\n  if (storeFilterState.value.selectedDepartment === null) {\n    return\n  }\n\n  const training = await apiGetTrainingByDepartmentId(storeFilterState.value.selectedDepartment.id)\n\n  if (training) {\n    storeSetTraining(training)\n  }\n}\nonUnmounted(() => {\n  storeClearTraining()\n})\n</script>\n\n<template>\n  <MainContent main-content-title=\"Manage Training\">\n    <div\n      v-if=\"storeFilterState.selectedDepartment && userHasPermissionInDepartment(\n        AppPermissions.MANAGE_TRAINING,\n        storeFilterState.selectedDepartment,\n      )\"\n      class=\"mt-12 flex w-full justify-end\"\n    >\n      <RouterLink\n        :to=\"{ name: $Routes.TrainingCreate }\"\n        class=\"block w-1/2 rounded-md bg-blue-600 px-3 py-1.5 text-center text-sm font-semibold leading-6 text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 hover:bg-blue-500 md:w-48\"\n      >\n        Add Training\n      </RouterLink>\n    </div>\n\n    <VDataFilters\n      :department-permissions-required=\"[\n        AppPermissions.VIEW_TRAINING,\n      ]\"\n      filter-by-departments\n      @filter-state-updated=\"handleFilterStateUpdate\"\n    />\n\n    <div class=\"flex flex-col pb-4\">\n      <div class=\"flow-root md:mt-8\">\n        <div class=\"overflow-x-auto\">\n          <div class=\"inline-block min-w-full py-2 align-middle\">\n            <div\n              v-if=\"storeFilterState.selectedDepartment === null || actionIsInProgress(trainingActions.getTrainingByDepartmentId)\"\n              class=\"flex h-[50px] items-center justify-center rounded border border-gray-100 bg-gray-50 shadow\"\n            >\n              <ProgressSpinner class=\"h-5 w-5 text-blue-600\" />\n            </div>\n\n            <table\n              v-else\n              class=\"min-w-full divide-y divide-gray-300 rounded border border-gray-100 bg-white shadow\"\n            >\n              <thead>\n                <tr>\n                  <th scope=\"col\" class=\"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900\">\n                    Training Name\n                  </th>\n                  <th scope=\"col\" colspan=\"2\" class=\"bg-gray-50 px-3 py-3.5\" />\n                </tr>\n              </thead>\n              <tbody class=\"divide-y divide-gray-200\">\n                <template v-if=\"storeTraining.length === 0\">\n                  <tr>\n                    <td colspan=\"8\" class=\"px-3 py-3.5 text-center text-sm text-gray-500\">\n                      No training found.\n                    </td>\n                  </tr>\n                </template>\n\n                <template v-else>\n                  <tr\n                    v-for=\"t in storeTraining\"\n                    :key=\"t.id\"\n                  >\n                    <td class=\"flex items-center whitespace-nowrap p-3 text-sm font-medium text-gray-900\">\n                      {{ t.name }}\n                    </td>\n                    <td class=\"relative whitespace-nowrap p-3 text-right text-sm font-medium\">\n                      <RouterLink\n                        v-if=\"storeFilterState.selectedDepartment && userHasPermissionInDepartment(\n                          AppPermissions.MANAGE_TRAINING,\n                          storeFilterState.selectedDepartment,\n                        )\"\n                        :to=\"{ name: $Routes.TrainingEdit, params: { trainingId: t.id } }\"\n                        class=\"text-blue-600 hover:text-blue-900\"\n                      >\n                        View\n                      </RouterLink>\n                    </td>\n                  </tr>\n                </template>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </MainContent>\n</template>\n"],"names":["trainingActions","useTraining","actionIsInProgress","useUi","storeFilterState","storeToRefs","useUiStore","storeSetFilterState","apiGetTrainingByDepartmentId","storeSetTraining","storeClearTraining","useTrainingStore","storeTraining","userHasPermissionInDepartment","useAuth","handleFilterStateUpdate","newFilterState","training","onUnmounted"],"mappings":"0yHAcM,KAAA,CAAE,gBAAAA,GAAoBC,IACtB,CAAE,mBAAAC,GAAuBC,IAEzB,CAAE,iBAAAC,CAAqB,EAAAC,EAAYC,EAAY,CAAA,EAC/C,CAAE,oBAAAC,GAAwBD,IAC1B,CAAE,6BAAAE,GAAiCP,IACnC,CAAE,iBAAAQ,EAAkB,mBAAAC,CAAmB,EAAIC,EAAiB,EAC5D,CAAE,cAAAC,CAAkB,EAAAP,EAAYM,EAAkB,CAAA,EAElD,CAAE,8BAAAE,GAAkCC,IAEpCC,EAA0B,MAAOC,GAAiC,CAGlE,GAFJT,EAAoBS,CAAc,EAE9BZ,EAAiB,MAAM,qBAAuB,KAChD,OAGF,MAAMa,EAAW,MAAMT,EAA6BJ,EAAiB,MAAM,mBAAmB,EAAE,EAE5Fa,GACFR,EAAiBQ,CAAQ,CAC3B,EAEF,OAAAC,EAAY,IAAM,CACGR,GAAA,CACpB"}