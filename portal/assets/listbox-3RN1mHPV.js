import{j as S,e as E,g as x,p as X,q as M,w as K,h as $,F as Y,v as G,t as J,n as k,f as Z,a8 as D}from"./vue.esm-bundler-CYPfFjdk.js";import{d as _,e as ee}from"./form-TGXPuq_M.js";import{o as g,u as P,f as te,E as le,s as ae,A as V,T as oe,t as C,N as z,a as m}from"./keyboard-64MH3N5t.js";import{a as ne,b as ie,h as re,t as ue,d as B,l as se,O as de}from"./open-closed-nhb_Ydho.js";import{s as ve}from"./use-resolve-button-type-49aRxFpo.js";function U(t){return[t.screenX,t.screenY]}function pe(){let t=S([-1,-1]);return{wasMoved(i){let o=U(i);return t.value[0]===o[0]&&t.value[1]===o[1]?!1:(t.value=o,!0)},update(i){t.value=U(i)}}}function ce(t){throw new Error("Unexpected object: "+t)}var h=(t=>(t[t.First=0]="First",t[t.Previous=1]="Previous",t[t.Next=2]="Next",t[t.Last=3]="Last",t[t.Specific=4]="Specific",t[t.Nothing=5]="Nothing",t))(h||{});function fe(t,i){let o=i.resolveItems();if(o.length<=0)return null;let s=i.resolveActiveIndex(),e=s??-1;switch(t.focus){case 0:{for(let l=0;l<o.length;++l)if(!i.resolveDisabled(o[l],l,o))return l;return s}case 1:{e===-1&&(e=o.length);for(let l=e-1;l>=0;--l)if(!i.resolveDisabled(o[l],l,o))return l;return s}case 2:{for(let l=e+1;l<o.length;++l)if(!i.resolveDisabled(o[l],l,o))return l;return s}case 3:{for(let l=o.length-1;l>=0;--l)if(!i.resolveDisabled(o[l],l,o))return l;return s}case 4:{for(let l=0;l<o.length;++l)if(i.resolveId(o[l],l,o)===t.id)return l;return s}case 5:return null;default:ce(t)}}let q=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function H(t){var i,o;let s=(i=t.innerText)!=null?i:"",e=t.cloneNode(!0);if(!(e instanceof HTMLElement))return s;let l=!1;for(let b of e.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))b.remove(),l=!0;let p=l?(o=e.innerText)!=null?o:"":s;return q.test(p)&&(p=p.replace(q,"")),p}function be(t){let i=t.getAttribute("aria-label");if(typeof i=="string")return i.trim();let o=t.getAttribute("aria-labelledby");if(o){let s=o.split(" ").map(e=>{let l=document.getElementById(e);if(l){let p=l.getAttribute("aria-label");return typeof p=="string"?p.trim():H(l).trim()}return null}).filter(Boolean);if(s.length>0)return s.join(", ")}return H(t).trim()}function me(t){let i=S(""),o=S("");return()=>{let s=g(t);if(!s)return"";let e=s.innerText;if(i.value===e)return o.value;let l=be(s).trim().toLowerCase();return i.value=e,o.value=l,l}}function ge(t,i){return t===i}var xe=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(xe||{}),he=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(he||{}),Oe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(Oe||{});function ye(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let Q=Symbol("ListboxContext");function j(t){let i=Z(Q,null);if(i===null){let o=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(o,j),o}return i}let Te=E({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>ge},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:i,attrs:o,emit:s}){let e=S(1),l=S(null),p=S(null),b=S(null),f=S([]),a=S(""),n=S(null),R=S(1);function w(r=u=>u){let u=n.value!==null?f.value[n.value]:null,d=de(r(f.value.slice()),y=>g(y.dataRef.domRef)),c=u?d.indexOf(u):null;return c===-1&&(c=null),{options:d,activeOptionIndex:c}}let L=x(()=>t.multiple?1:0),[T,I]=_(x(()=>t.modelValue),r=>s("update:modelValue",r),x(()=>t.defaultValue)),F=x(()=>T.value===void 0?P(L.value,{1:[],0:void 0}):T.value),v={listboxState:e,value:F,mode:L,compare(r,u){if(typeof t.by=="string"){let d=t.by;return(r==null?void 0:r[d])===(u==null?void 0:u[d])}return t.by(r,u)},orientation:x(()=>t.horizontal?"horizontal":"vertical"),labelRef:l,buttonRef:p,optionsRef:b,disabled:x(()=>t.disabled),options:f,searchQuery:a,activeOptionIndex:n,activationTrigger:R,closeListbox(){t.disabled||e.value!==1&&(e.value=1,n.value=null)},openListbox(){t.disabled||e.value!==0&&(e.value=0)},goToOption(r,u,d){if(t.disabled||e.value===1)return;let c=w(),y=fe(r===h.Specific?{focus:h.Specific,id:u}:{focus:r},{resolveItems:()=>c.options,resolveActiveIndex:()=>c.activeOptionIndex,resolveId:A=>A.id,resolveDisabled:A=>A.dataRef.disabled});a.value="",n.value=y,R.value=d??1,f.value=c.options},search(r){if(t.disabled||e.value===1)return;let u=a.value!==""?0:1;a.value+=r.toLowerCase();let d=(n.value!==null?f.value.slice(n.value+u).concat(f.value.slice(0,n.value+u)):f.value).find(y=>y.dataRef.textValue.startsWith(a.value)&&!y.dataRef.disabled),c=d?f.value.indexOf(d):-1;c===-1||c===n.value||(n.value=c,R.value=1)},clearSearch(){t.disabled||e.value!==1&&a.value!==""&&(a.value="")},registerOption(r,u){let d=w(c=>[...c,{id:r,dataRef:u}]);f.value=d.options,n.value=d.activeOptionIndex},unregisterOption(r){let u=w(d=>{let c=d.findIndex(y=>y.id===r);return c!==-1&&d.splice(c,1),d});f.value=u.options,n.value=u.activeOptionIndex,R.value=1},theirOnChange(r){t.disabled||I(r)},select(r){t.disabled||I(P(L.value,{0:()=>r,1:()=>{let u=D(v.value.value).slice(),d=D(r),c=u.findIndex(y=>v.compare(d,D(y)));return c===-1?u.push(d):u.splice(c,1),u}}))}};ne([p,b],(r,u)=>{var d;v.closeListbox(),ie(u,re.Loose)||(r.preventDefault(),(d=g(p))==null||d.focus())},x(()=>e.value===0)),X(Q,v),ue(x(()=>P(e.value,{0:B.Open,1:B.Closed})));let O=x(()=>{var r;return(r=g(p))==null?void 0:r.closest("form")});return M(()=>{K([O],()=>{if(!O.value||t.defaultValue===void 0)return;function r(){v.theirOnChange(t.defaultValue)}return O.value.addEventListener("reset",r),()=>{var u;(u=O.value)==null||u.removeEventListener("reset",r)}},{immediate:!0})}),()=>{let{name:r,modelValue:u,disabled:d,form:c,...y}=t,A={open:e.value===0,disabled:d,value:F.value};return $(Y,[...r!=null&&F.value!=null?ee({[r]:F.value}).map(([N,W])=>$(te,le({features:ae.Hidden,key:N,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:c,name:N,value:W}))):[],V({ourProps:{},theirProps:{...o,...oe(y,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:A,slots:i,attrs:o,name:"Listbox"})])}}}),Pe=E({name:"ListboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:()=>`headlessui-listbox-label-${C()}`}},setup(t,{attrs:i,slots:o}){let s=j("ListboxLabel");function e(){var l;(l=g(s.buttonRef))==null||l.focus({preventScroll:!0})}return()=>{let l={open:s.listboxState.value===0,disabled:s.disabled.value},{id:p,...b}=t,f={id:p,ref:s.labelRef,onClick:e};return V({ourProps:f,theirProps:b,slot:l,attrs:i,slots:o,name:"ListboxLabel"})}}}),Fe=E({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-listbox-button-${C()}`}},setup(t,{attrs:i,slots:o,expose:s}){let e=j("ListboxButton");s({el:e.buttonRef,$el:e.buttonRef});function l(a){switch(a.key){case m.Space:case m.Enter:case m.ArrowDown:a.preventDefault(),e.openListbox(),k(()=>{var n;(n=g(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.First)});break;case m.ArrowUp:a.preventDefault(),e.openListbox(),k(()=>{var n;(n=g(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.Last)});break}}function p(a){switch(a.key){case m.Space:a.preventDefault();break}}function b(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),k(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),ye(()=>{var n;return(n=g(e.optionsRef))==null?void 0:n.focus({preventScroll:!0})})))}let f=ve(x(()=>({as:t.as,type:i.type})),e.buttonRef);return()=>{var a,n;let R={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{id:w,...L}=t,T={ref:e.buttonRef,id:w,type:f.value,"aria-haspopup":"listbox","aria-controls":(a=g(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(n=g(e.labelRef))==null?void 0:n.id,w].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:l,onKeyup:p,onClick:b};return V({ourProps:T,theirProps:L,slot:R,attrs:i,slots:o,name:"ListboxButton"})}}}),ke=E({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:()=>`headlessui-listbox-options-${C()}`}},setup(t,{attrs:i,slots:o,expose:s}){let e=j("ListboxOptions"),l=S(null);s({el:e.optionsRef,$el:e.optionsRef});function p(a){switch(l.value&&clearTimeout(l.value),a.key){case m.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case m.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let n=e.options.value[e.activeOptionIndex.value];e.select(n.dataRef.value)}e.mode.value===0&&(e.closeListbox(),k(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})}));break;case P(e.orientation.value,{vertical:m.ArrowDown,horizontal:m.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Next);case P(e.orientation.value,{vertical:m.ArrowUp,horizontal:m.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Previous);case m.Home:case m.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.First);case m.End:case m.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Last);case m.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),k(()=>{var n;return(n=g(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case m.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),l.value=setTimeout(()=>e.clearSearch(),350));break}}let b=se(),f=x(()=>b!==null?(b.value&B.Open)===B.Open:e.listboxState.value===0);return()=>{var a,n;let R={open:e.listboxState.value===0},{id:w,...L}=t,T={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(n=g(e.buttonRef))==null?void 0:n.id,"aria-orientation":e.orientation.value,id:w,onKeydown:p,role:"listbox",tabIndex:0,ref:e.optionsRef};return V({ourProps:T,theirProps:L,slot:R,attrs:i,slots:o,features:z.RenderStrategy|z.Static,visible:f.value,name:"ListboxOptions"})}}}),Ie=E({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:()=>`headlessui-listbox.option-${C()}`}},setup(t,{slots:i,attrs:o,expose:s}){let e=j("ListboxOption"),l=S(null);s({el:l,$el:l});let p=x(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===t.id:!1),b=x(()=>P(e.mode.value,{0:()=>e.compare(D(e.value.value),D(t.value)),1:()=>D(e.value.value).some(v=>e.compare(D(v),D(t.value)))})),f=x(()=>P(e.mode.value,{1:()=>{var v;let O=D(e.value.value);return((v=e.options.value.find(r=>O.some(u=>e.compare(D(u),D(r.dataRef.value)))))==null?void 0:v.id)===t.id},0:()=>b.value})),a=me(l),n=x(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:l}));M(()=>e.registerOption(t.id,n)),G(()=>e.unregisterOption(t.id)),M(()=>{K([e.listboxState,b],()=>{e.listboxState.value===0&&b.value&&P(e.mode.value,{1:()=>{f.value&&e.goToOption(h.Specific,t.id)},0:()=>{e.goToOption(h.Specific,t.id)}})},{immediate:!0})}),J(()=>{e.listboxState.value===0&&p.value&&e.activationTrigger.value!==0&&k(()=>{var v,O;return(O=(v=g(l))==null?void 0:v.scrollIntoView)==null?void 0:O.call(v,{block:"nearest"})})});function R(v){if(t.disabled)return v.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),k(()=>{var O;return(O=g(e.buttonRef))==null?void 0:O.focus({preventScroll:!0})}))}function w(){if(t.disabled)return e.goToOption(h.Nothing);e.goToOption(h.Specific,t.id)}let L=pe();function T(v){L.update(v)}function I(v){L.wasMoved(v)&&(t.disabled||p.value||e.goToOption(h.Specific,t.id,0))}function F(v){L.wasMoved(v)&&(t.disabled||p.value&&e.goToOption(h.Nothing))}return()=>{let{disabled:v}=t,O={active:p.value,selected:b.value,disabled:v},{id:r,value:u,disabled:d,...c}=t,y={id:r,ref:l,role:"option",tabIndex:v===!0?void 0:-1,"aria-disabled":v===!0?!0:void 0,"aria-selected":b.value,disabled:void 0,onClick:R,onFocus:w,onPointerenter:T,onMouseenter:T,onPointermove:I,onMousemove:I,onPointerleave:F,onMouseleave:F};return V({ourProps:y,theirProps:c,slot:O,attrs:o,slots:i,name:"ListboxOption"})}}});export{ke as A,Pe as E,Ie as F,Te as I,h as c,fe as f,Fe as j,me as p,pe as u};
