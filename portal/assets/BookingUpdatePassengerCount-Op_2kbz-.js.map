{"version":3,"file":"BookingUpdatePassengerCount-Op_2kbz-.js","sources":["../../src/features/booking/update-passenger-count/BookingUpdatePassengerCount.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed, toRefs } from 'vue'\nimport { useCloned } from '@vueuse/core'\nimport { push } from 'notivue'\n\nimport { type TourBooking } from '@/shared/types'\nimport { useTourBookingUpdate } from '@/shared/api/booking'\nimport { PNumberInput } from '@/shared/ui/PNumberInput'\nimport { POverlay } from '@/shared/ui/POverlay'\nimport { PPopover, PPopoverButton, PPopoverPanel } from '@/shared/ui/PPopover'\nimport IconPerson from '@/shared/ui/icons/IconPerson.vue'\n\nexport interface Props {\n  tourBookingId: TourBooking['id']\n  totalCount: number\n  arrivedCount: number | null\n}\n\nconst props = defineProps<Props>()\nconst { tourBookingId, totalCount } = toRefs(props)\n\nconst arrivedCount = computed(() => props.arrivedCount ?? totalCount.value)\n\nconst { cloned: arrivedCountModel, sync: reset } = useCloned(arrivedCount)\n\nconst { mutate, isPending } = useTourBookingUpdate()\n\nconst saveTotalPassengerCount = (close: () => void) => {\n  mutate({\n    tourBookingId: tourBookingId.value,\n    arrivedPassengerCount: arrivedCountModel.value,\n  }, {\n    onSuccess() {\n      close()\n\n      push.success({ message: 'Passengers count saved' })\n    },\n  })\n}\n</script>\n\n<template>\n  <PPopover\n    v-slot=\"{ close }\"\n    :float=\"{\n      placement: 'bottom',\n      onHide: reset,\n    }\"\n  >\n    <PPopoverButton\n      class=\"flex items-center justify-center gap-1 text-lg focus:outline-none\"\n    >\n      <IconPerson class=\"size-5 text-blue-600\" />\n\n      <span class=\"block min-w-14 text-left\">\n        {{ arrivedCountModel }}\n\n        <span v-if=\"arrivedCountModel !== totalCount\">\n          / {{ totalCount }}\n        </span>\n      </span>\n    </PPopoverButton>\n\n    <PPopoverPanel>\n      <div class=\"flex h-full flex-col gap-3\">\n        <PNumberInput v-model=\"arrivedCountModel\" :min=\"0\" :max=\"totalCount\" />\n\n        <POverlay :show=\"isPending\" class=\"flex justify-end\">\n          <button\n            class=\"select-none text-blue-500 transition-colors hover:text-blue-800\"\n            @click=\"saveTotalPassengerCount(close)\"\n          >\n            Save changes\n          </button>\n        </POverlay>\n      </div>\n    </PPopoverPanel>\n  </PPopover>\n</template>\n"],"names":["props","__props","tourBookingId","totalCount","toRefs","arrivedCount","computed","arrivedCountModel","reset","useCloned","mutate","isPending","useTourBookingUpdate","saveTotalPassengerCount","close","push"],"mappings":"4rBAkBA,MAAMA,EAAQC,EACR,CAAE,cAAAC,EAAe,WAAAC,CAAW,EAAIC,EAAOJ,CAAK,EAE5CK,EAAeC,EAAS,IAAMN,EAAM,cAAgBG,EAAW,KAAK,EAEpE,CAAE,OAAQI,EAAmB,KAAMC,GAAUC,EAAUJ,CAAY,EAEnE,CAAE,OAAAK,EAAQ,UAAAC,CAAU,EAAIC,EAAqB,EAE7CC,EAA2BC,GAAsB,CAC9CJ,EAAA,CACL,cAAeR,EAAc,MAC7B,sBAAuBK,EAAkB,KAAA,EACxC,CACD,WAAY,CACJO,IAENC,EAAK,QAAQ,CAAE,QAAS,wBAA0B,CAAA,CACpD,CAAA,CACD,CAAA"}