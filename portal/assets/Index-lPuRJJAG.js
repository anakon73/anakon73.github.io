import{e as N,z as W,j as q,q as A,o as y,k,l as a,G as x,F as T,H as z,D as V,E as j,C as P,b as O,B as S,g as B,A as $,ad as G}from"./vue.esm-bundler-CYPfFjdk.js";import{s as J}from"./schemas-74JEr9Jm.js";import{g as K,e as H,h as Q,i as X,M as Y}from"./preview-D0Pi-YKn.js";import"./api-cJzoLyfI.js";import{a as Z}from"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import{r as I,t as b,d as ee,a as te,s as R,g as E,f as C,b as oe}from"./index-05uTbNHo.js";import{i as re}from"./index-TCXC35p5.js";import{P as ae}from"./ProgressSpinner-lCLkagxy.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./api-B2HcjM2j.js";import"./PAlert-quHLeqTA.js";import"./index-VqpYtbVe.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./IconBus-0QPjtZ9u.js";import"./PButton-h9_xezBg.js";import"./PAvatar-wq6oK0Zr.js";import"./PPhoneLink-wKLYRG_F.js";import"./PToggle-mLVcOzrp.js";import"./XMarkIcon-_tXc_TyD.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./PInput-iZb_REtl.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";function ie(v,m,e){var s,f,l,i,n,t,o,d,r,p;I(2,arguments);var c=b(v),g=b(m),h=oe(),_=(s=(f=e==null?void 0:e.locale)!==null&&f!==void 0?f:h.locale)!==null&&s!==void 0?s:ee,D=te((l=(i=(n=(t=e==null?void 0:e.weekStartsOn)!==null&&t!==void 0?t:e==null||(o=e.locale)===null||o===void 0||(d=o.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&n!==void 0?n:h.weekStartsOn)!==null&&i!==void 0?i:(r=h.locale)===null||r===void 0||(p=r.options)===null||p===void 0?void 0:p.weekStartsOn)!==null&&l!==void 0?l:0);if(!_.localize)throw new RangeError("locale must contain localize property");if(!_.formatLong)throw new RangeError("locale must contain formatLong property");if(!_.formatRelative)throw new RangeError("locale must contain formatRelative property");var u=K(c,g);if(isNaN(u))throw new RangeError("Invalid time value");var w;u<-6?w="other":u<-1?w="lastWeek":u<0?w="yesterday":u<1?w="today":u<2?w="tomorrow":u<7?w="nextWeek":w="other";var L=R(c,E(c)),M=R(g,E(g)),U=_.formatRelative(w,L,M,{locale:_,weekStartsOn:D});return C(c,U,{locale:_,weekStartsOn:D})}function se(v,m){I(2,arguments);var e=b(v),s=b(m);return e.getTime()>s.getTime()}function le(v,m){I(2,arguments);var e=b(v),s=b(m);return e.getTime()<s.getTime()}const ne={key:0,class:"divide-y divide-gray-100 overflow-hidden rounded-xl bg-white shadow-2xl ring-1 ring-black/5 transition-all @container"},de={class:"flex h-[500px] transform-gpu flex-col divide-x divide-gray-100 @md:flex-row"},me={class:"min-h-[180px] min-w-0 flex-auto overflow-y-auto overflow-x-hidden border-b scrollbar-thin scrollbar-track-gray-100 scrollbar-thumb-blue-500/20 @md:border-0"},pe={class:"sticky top-0 z-10 border-b bg-white px-6 py-4 text-xs font-semibold text-gray-500"},ce=["onClick"],ue={class:"text-gray-500"},ve={class:"flex items-center gap-2"},fe={class:"min-w-7 rounded-xl bg-gray-900 px-1.5 py-0.5 text-center"},ge={class:"text-[0.6rem] leading-5 text-white"},he=["textContent"],_e=["textContent"],F=N({__name:"UpcomingShiftsWidget",props:{title:{},operationalBaseId:{}},setup(v){const{getUpcomingShifts:m,user:e}=H(),s=v,{operationalBaseId:f}=W(s),l=q([]),{data:i}=Z(),n=t=>{const o=ie(new Date(t),new Date);return o.split("at")[0].charAt(0).toUpperCase()+o.split("at")[0].slice(1)};return A(async()=>{var t;try{l.value=((t=await m(e.value.id.toString(),f.value))==null?void 0:t.map(o=>{var D;const{end:d,start:r}=o.scheduledDeparture,p=new Date(r),c=new Date(d),g=`${n(p)} ${C(p,"HH:mm")}`,h=C(c,re(p,c)?"HH:mm":"EEEE HH:mm"),_=`${g} - ${h}`;return{...o,vehicle:(D=i.value)==null?void 0:D.find(u=>u.id===o.vehicleId),isOngoing:se(new Date,p)&&le(new Date,c),displayDate:_,scheduledDeparture:o.scheduledDeparture}}))??[]}catch(o){console.log(o)}}),(t,o)=>{const d=j("RouterLink");return l.value.length?(y(),k("div",ne,[a("div",de,[a("div",me,[a("h2",pe," My Shifts - "+x(t.title),1),(y(!0),k(T,null,z(l.value,(r,p)=>(y(),k("div",{key:r.id,class:P(["w-full cursor-pointer px-5 py-2 text-sm hover:bg-gray-100",[p+1!==l.value.length&&"border-b",r.isOngoing&&"bg-blue-100"]])},[O(d,{to:{name:t.$Routes.DepartureShow,params:{departureId:r.scheduledDeparture.id}},custom:""},{default:S(({navigate:c})=>{var g,h;return[a("div",{class:"flex flex-col gap-2",onClick:c},[a("p",null,x(r.displayDate),1),a("p",ue,x(r.scheduledDeparture.tour.code)+" "+x(r.scheduledDeparture.tour.name),1),a("div",ve,[a("div",fe,[a("p",ge,x((g=r.vehicle)==null?void 0:g.title),1)]),a("p",{class:"text-gray-500",textContent:x((h=r.vehicle)==null?void 0:h.registrationNumber)},null,8,he)]),a("p",{class:"text-blue-400",textContent:x(r.scheduledDeparture.comment)},null,8,_e)],8,ce)]}),_:2},1032,["to"])],2))),128))])])])):V("",!0)}}});F.__docgenInfo={exportName:"default",displayName:"UpcomingShiftsWidget",description:"",tags:{},props:[{name:"title",required:!0,type:{name:"string"}},{name:"operationalBaseId",required:!0,type:{name:"union",elements:[{name:"number"},{name:"null"}]}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/dashboard/widgets/UpcomingShiftsWidget.vue"]};const we={class:"@container"},xe={class:"grid grid-cols-1 gap-6 @[900px]:grid-cols-3"},ye={class:"flex h-[30rem] w-full items-center justify-center rounded-xl bg-white shadow-2xl ring-1 ring-black/5"},be=N({__name:"Index",setup(v){const{selectedDepartmentId:m,selectedOperationalBaseId:e}=J(Q()),{user:s}=H(),{data:f}=X({departmentIds:B(()=>{var i;return m.value?[m.value]:(i=s.value)==null?void 0:i.departments.map(n=>n.id)})}),l=B(()=>{var i;if(e.value){const n=(i=f.value)==null?void 0:i.find(t=>t.id===e.value);return n?[n]:[]}else return f.value??[]});return(i,n)=>(y(),$(Y,{"main-content-title":"Dashboard"},{default:S(()=>[a("div",we,[a("div",xe,[(y(!0),k(T,null,z(l.value,({id:t,name:o,department:d})=>(y(),$(G,{key:t},{fallback:S(()=>[a("div",ye,[O(ae,{class:"size-8 text-blue-400"})])]),default:S(()=>[O(F,{"operational-base-id":t,title:l.value.length<=1?d==null?void 0:d.name:o},null,8,["operational-base-id","title"])]),_:2},1024))),128))])])]),_:1}))}});be.__docgenInfo={exportName:"default",displayName:"dashboard",description:"",tags:{},sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/dashboard/Index.vue"]};export{be as default};
