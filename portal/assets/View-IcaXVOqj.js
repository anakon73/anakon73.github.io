import{e as V,z as M,j as A,q as S,w as U,o as l,A as n,B as g,E as B,l as t,u as m,b as C,k as P,J as r,P as y,S as p,G as c,F,D as L}from"./vue.esm-bundler-CYPfFjdk.js";import{u as q}from"./vue-router-E7v71uM3.js";import{R as E}from"./RightDrawer-Lpr6admO.js";import{a as j,e as x,A as T}from"./preview-D0Pi-YKn.js";import{I as z}from"./IconClose-tbzieUCA.js";import{P as G}from"./ProgressSpinner-lCLkagxy.js";import{u as J}from"./useDeviation-ZZmaucR8.js";import{R as O}from"./routes-WhYxSpGG.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./schemas-74JEr9Jm.js";import"./index-LmGWO5sK.js";import"./models-qWR1FMGP.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";const $={class:"isolate flex flex-col items-center justify-center border-l bg-white pb-6"},H={class:"sticky top-0 z-10 flex w-full items-center justify-end bg-white p-6"},K={id:"create_deviation_form",class:"w-full space-y-8 divide-y divide-gray-200 px-6 md:px-12"},Q=t("div",{class:"mb-6"},[t("h3",{class:"text-base font-semibold leading-6 text-gray-900"}," View deviation. "),t("p",{class:"mt-1 text-sm text-gray-500"}," Details of the deviation are shown below. ")],-1),W={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},X={class:"sm:col-span-3"},Y=t("label",{for:"deviation_date_input",class:"block text-sm font-medium text-gray-700"}," Date and Time ",-1),Z={class:"mt-1"},tt={class:"sm:col-span-3"},et=t("label",{for:"staff_involved_id",class:"block text-sm font-medium text-gray-700"}," Staff Involved ",-1),ot={class:"mt-1"},st={class:"sm:col-span-3"},it=t("label",{for:"staff_involved_id",class:"block text-sm font-medium text-gray-700"}," Staff Reporting ",-1),rt={class:"mt-1"},at={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},lt={class:"sm:col-span-6"},mt=t("label",{for:"category",class:"block text-sm font-medium text-gray-700"}," Category ",-1),dt={class:"mt-1"},nt={class:"grid grid-cols-1 gap-x-4 gap-y-6 pt-6 sm:grid-cols-6"},pt={class:"sm:col-span-6"},ct=t("label",{for:"incident_description",class:"block text-sm font-medium text-gray-700 sm:mt-px sm:pt-2"}," Details of the incident ",-1),ut={class:"mt-1 sm:col-span-2"},ft=V({__name:"View",props:{deviationId:{}},setup(h){var b,_;const w=h,{deviationId:u}=M(w),{actionIsInProgress:f}=j(),{deviationActions:k,getDeviationById:v}=J(),{fetchAndStoreUsersIndex:I,userActions:D}=x(),{user:d}=x(),e=A(null),N=q(),R=(_=(b=d.value)==null?void 0:b.permissions)==null?void 0:_.some(i=>i.permission.slug===T.MANAGE_DEVIATIONS);return S(async()=>{var o,a;const i=(o=d.value)==null?void 0:o.departments.find(s=>s.primary);if(i){const[s]=await Promise.all([await v(u.value.toString()),I(i.id,!1)]);!R&&(s==null?void 0:s.staffMemberInvolved.id)!==((a=d.value)==null?void 0:a.id)?await N.push({name:O.Forbidden}):e.value=s}}),U(u,async i=>{if(i){const o=await v(i.toString());o&&(e.value=o)}}),(i,o)=>{const a=B("RouterLink");return l(),n(E,null,{default:g(()=>[t("div",$,[t("div",H,[m(f)(m(k).getDeviationById)||m(f)(m(D).getAllUsers)?(l(),n(G,{key:0,class:"h-5 w-5 text-blue-500"})):(l(),n(a,{key:1,to:{name:i.$Routes.Deviations}},{default:g(()=>[C(z,{class:"h-5 w-5 fill-red-400"})]),_:1},8,["to"]))]),t("form",K,[Q,e.value?(l(),P(F,{key:0},[t("div",W,[t("div",X,[Y,t("div",Z,[r(t("input",{id:"deviation_date_input","onUpdate:modelValue":o[0]||(o[0]=s=>e.value.dateInput=s),type:"datetime-local",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:""},null,512),[[y,e.value.dateInput]])])]),t("div",tt,[et,t("div",ot,[r(t("select",{id:"staff_involved_id","onUpdate:modelValue":o[1]||(o[1]=s=>e.value.staffMemberInvolved.fullName=s),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:"",disabled:""},[t("option",null,c(e.value.staffMemberInvolved.fullName),1)],512),[[p,e.value.staffMemberInvolved.fullName]])])]),t("div",st,[it,t("div",rt,[r(t("select",{id:"staff_involved_id","onUpdate:modelValue":o[2]||(o[2]=s=>e.value.staffMemberReporting.fullName=s),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",required:"",disabled:""},[t("option",null,c(e.value.staffMemberReporting.fullName),1)],512),[[p,e.value.staffMemberReporting.fullName]])])])]),t("div",at,[t("div",lt,[mt,t("div",dt,[r(t("select",{id:"category","onUpdate:modelValue":o[3]||(o[3]=s=>e.value.categoryLabel=s),class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:""},[t("option",null,c(e.value.categoryLabel),1)],512),[[p,e.value.categoryLabel]])])])]),t("div",nt,[t("div",pt,[ct,t("div",ut,[r(t("textarea",{id:"incident_description","onUpdate:modelValue":o[4]||(o[4]=s=>e.value.details=s),rows:"3",class:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",disabled:""},null,512),[[y,e.value.details]])])])])],64)):L("",!0)])])]),_:1})}}});ft.__docgenInfo={exportName:"default",displayName:"View",description:"",tags:{},props:[{name:"deviationId",required:!0,type:{name:"number"}}],sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/deviations/View.vue"]};export{ft as default};
