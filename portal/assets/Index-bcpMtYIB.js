import{j as B,e as F,v as M,o as a,A as h,B as _,E as R,l as t,b as g,x as D,u as e,k as p,F as U,H as E,G as d,D as L}from"./vue.esm-bundler-CYPfFjdk.js";import{d as P,s as w}from"./schemas-74JEr9Jm.js";import{a as T,f as I,e as j,M as G,A as S}from"./preview-D0Pi-YKn.js";import{P as $}from"./ProgressSpinner-lCLkagxy.js";import{u as k}from"./useDeviation-ZZmaucR8.js";import{_ as q}from"./VDataFilters-2mcnRfw0.js";import{u as H}from"./useAuth-8d_1_S6I.js";import"./index-LmGWO5sK.js";import"./vue-router-E7v71uM3.js";import"./routes-WhYxSpGG.js";import"./models-qWR1FMGP.js";import"./chunk-UXHY756F-iEg6Hh0Y.js";import"./index-C1vJkiWb.js";import"./_commonjsHelpers-4gQjN7DL.js";import"./preview-errors-7FWlPnjy.js";import"./index-PPLHz8o0.js";import"./PDays-npMhi6Nw.js";import"./index-baqd9Qr3.js";import"./index-TCXC35p5.js";import"./index-05uTbNHo.js";import"./PPopoverPanel-RNuJphX8.js";import"./headlessui-float-sqR0azf2.js";import"./transition-qpXhaAaU.js";import"./keyboard-64MH3N5t.js";import"./open-closed-nhb_Ydho.js";import"./use-root-containers-gEPBKDr2.js";import"./use-resolve-button-type-49aRxFpo.js";import"./iframe-ufxlS10p.js";import"../sb-preview/runtime.js";import"./query-G1AwWss6.js";import"./ChevronDownIcon-AgxEjrtE.js";import"./listbox-3RN1mHPV.js";import"./form-TGXPuq_M.js";import"./DepartureList-w5NrqMJ9.js";import"./DepartureAssignStaffAndVehicles-8AoBdfT8.js";import"./api-B2HcjM2j.js";import"./api-cJzoLyfI.js";import"./PButton-h9_xezBg.js";import"./index-VqpYtbVe.js";import"./PInput-iZb_REtl.js";import"./POverlay-3jPNvx4x.js";import"./PSpinner-cF72MsvC.js";import"./IconBus-0QPjtZ9u.js";import"./_plugin-vue_export-helper-x3n3nnut.js";import"./IconPerson-i3ljUCnk.js";import"./SuggestedUser-4kWsZiWj.js";import"./PAvatar-wq6oK0Zr.js";import"./PlusCircleIcon-aSiXn_Mr.js";import"./SuggestedVehicle-r1TyKt-D.js";import"./ScheduledUser-esbe3tjU.js";import"./VehicleTitle-0pOySBND.js";import"./XMarkIcon-_tXc_TyD.js";import"./PPhoneLink-wKLYRG_F.js";import"./PAlert-quHLeqTA.js";import"./CheckCircleIcon-akbq8cGf.js";import"./XMarkIcon-t43a1P5Z.js";import"./PDialogTitle-rfxNVwSR.js";import"./description-LPuBJoU_.js";import"./DepartureListItem-I88AIHqM.js";import"./DepartureUpdateComment-2rt04tFb.js";import"./PTextarea-Wrr33MR5.js";import"./DepartureUpdateCommentPopover-euFlcGix.js";import"./DepartureUpdateStatus-zdhd3wV8.js";import"./PListboxLabel-U39qo3cm.js";import"./CheckIcon-WRJIoum8.js";import"./lib-Fy6oBlQ3.js";import"./PToggle-mLVcOzrp.js";import"./PRadio-sGATo2dT.js";import"./index-bhXQ3okY.js";import"./isNativeReflectConstruct-ubdnbphT.js";import"./mock-vjhcKIQW.js";import"./index-1aVAeLWL.js";import"./mock-UR5nntqf.js";import"./mock-CzN7Q16W.js";import"./mock-YoOI-P8k.js";import"./mock-psFphV_9.js";import"./mock-OgPWcINV.js";import"./useDepartment-RZahlhen.js";import"./useOperationalBase-kvvO22e1.js";import"./useRole-JNprELZd.js";const N=P("deviations",()=>{const s=B([]);function c(o){s.value=o}function u(o){s.value.push(o)}function i(o){const n=s.value.findIndex(m=>m.id===o.id);s.value[n]=o}function f(o){const n=s.value.findIndex(m=>m.id===o.id);n!==-1&&s.value.splice(n,1)}function v(){s.value=[]}return{storeSetDeviations:c,storeDeviations:s,storeAddDeviation:u,storeRemoveDeviation:f,storeUpdateDeviation:i,storeClearDeviations:v}}),O={class:"mt-12 flex w-full justify-end"},W={class:"flex flex-col pb-4"},z={class:"flow-root md:mt-8"},J={class:"overflow-x-auto"},K={class:"inline-block min-w-full py-2 align-middle"},Q={key:0,class:"flex h-[50px] items-center justify-center rounded border border-gray-100 bg-gray-50 shadow"},X={key:1,class:"min-w-full divide-y divide-gray-300 rounded border border-gray-100 bg-white shadow"},Y=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Time and date "),t("th",{scope:"col",class:"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Category "),t("th",{scope:"col",class:"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Staff involved "),t("th",{scope:"col",class:"bg-gray-50 px-3 py-3.5 text-left text-sm font-semibold text-gray-900"}," Staff reporting "),t("th",{scope:"col",class:"bg-gray-50 px-3 py-3.5"})])],-1),Z={class:"divide-y divide-gray-200"},tt={key:0},et=t("td",{colspan:"8",class:"px-3 py-3.5 text-center text-sm text-gray-500"}," No deviations found. ",-1),ot=[et],st={class:"p-3 text-sm text-gray-900"},it={class:"p-3 text-sm text-gray-900"},rt={class:"p-3 text-sm text-gray-900"},at={class:"p-3 text-sm text-gray-900"},nt={class:"p-3 text-right text-sm font-medium"},mt=F({__name:"Index",setup(s){const{deviationActions:c}=k(),{actionIsInProgress:u}=T(),{storeFilterState:i}=w(I()),{storeSetFilterState:f}=I(),{apiGetDeviationsByDepartmentId:v}=k(),{storeSetDeviations:o,storeClearDeviations:n}=N(),{storeDeviations:m}=w(N()),{user:A}=j(),{userHasPermissionInDepartment:C}=H(),V=async l=>{if(f(l),i.value.selectedDepartment===null)return;const x=await v(i.value.selectedDepartment.id);x&&o(x)};return M(()=>{n()}),(l,x)=>{const y=R("RouterLink");return a(),h(G,{"main-content-title":"Manage Deviations"},{default:_(()=>[t("div",O,[g(y,{to:{name:l.$Routes.CreateDeviation},class:"block w-1/2 rounded-md bg-blue-600 px-3 py-1.5 text-center text-sm font-semibold leading-6 text-white shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600 hover:bg-blue-500 md:w-48"},{default:_(()=>[D(" Log Deviation ")]),_:1},8,["to"])]),g(q,{"department-permissions-required":[e(S).VIEW_DEVIATIONS],"filter-by-departments":"",onFilterStateUpdated:V},null,8,["department-permissions-required"]),t("div",W,[t("div",z,[t("div",J,[t("div",K,[e(i).selectedDepartment===null||e(u)(e(c).getDeviationByDepartmentId)?(a(),p("div",Q,[g($,{class:"h-5 w-5 text-blue-600"})])):(a(),p("table",X,[Y,t("tbody",Z,[e(m).length===0?(a(),p("tr",tt,ot)):(a(!0),p(U,{key:1},E(e(m),r=>{var b;return a(),p("tr",{key:r.id},[t("td",st,d(r.dateLabel),1),t("td",it,d(r.categoryLabel),1),t("td",rt,d(r.staffMemberInvolved.fullName),1),t("td",at,d(r.staffMemberReporting.fullName),1),t("td",nt,[e(i).selectedDepartment&&e(C)(e(S).MANAGE_DEVIATIONS,e(i).selectedDepartment)||r.staffMemberInvolved.id===((b=e(A))==null?void 0:b.id)?(a(),h(y,{key:0,to:{name:l.$Routes.ViewDeviation,params:{deviationId:r.id}},class:"text-blue-600 hover:text-blue-900"},{default:_(()=>[D(" View ")]),_:2},1032,["to"])):L("",!0)])])}),128))])]))])])])])]),_:1})}}});mt.__docgenInfo={exportName:"default",displayName:"deviations",description:"",tags:{},sourceFiles:["D:/work/server/htdocs/aa-portal.is/src/pages/deviations/Index.vue"]};export{mt as default};
